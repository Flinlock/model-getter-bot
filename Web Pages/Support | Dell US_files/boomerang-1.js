function BOOMR_check_doc_domain(domain){if(window){if(!domain){if(window.parent===window||!document.getElementById("boomr-if-as"))return;if(window.BOOMR&&BOOMR.boomerang_frame&&BOOMR.window)try{BOOMR.boomerang_frame.document.domain!==BOOMR.window.document.domain&&(BOOMR.boomerang_frame.document.domain=BOOMR.window.document.domain)}catch(err){BOOMR.isCrossOriginError(err)||BOOMR.addError(err,"BOOMR_check_doc_domain.domainFix")}domain=document.domain}if(-1!==domain.indexOf(".")){try{window.parent.document;return}catch(err){document.domain=domain}try{window.parent.document;return}catch(err){domain=domain.replace(/^[\w\-]+\./,"")}BOOMR_check_doc_domain(domain)}}}BOOMR_start=(new Date).getTime();BOOMR_check_doc_domain();!function(w){var impl,boomr,d,createCustomEvent,dispatchEvent,visibilityState,visibilityChange,orig_w=w;w.parent!==w&&document.getElementById("boomr-if-as")&&"script"===document.getElementById("boomr-if-as").nodeName.toLowerCase()&&(w=w.parent);d=w.document;w.BOOMR||(w.BOOMR={});BOOMR=w.BOOMR;if(!BOOMR.version){BOOMR.version="1.0.0";BOOMR.window=w;BOOMR.boomerang_frame=orig_w;BOOMR.isIE8=!document.getElementsByClassName;BOOMR.plugins||(BOOMR.plugins={});!function(){try{void 0!==new w.CustomEvent("CustomEvent")&&(createCustomEvent=function(e_name,params){return new w.CustomEvent(e_name,params)})}catch(ignore){}try{!createCustomEvent&&d.createEvent&&d.createEvent("CustomEvent")&&(createCustomEvent=function(e_name,params){var evt=d.createEvent("CustomEvent");params=params||{cancelable:!1,bubbles:!1};evt.initCustomEvent(e_name,params.bubbles,params.cancelable,params.detail);return evt})}catch(ignore){}!createCustomEvent&&d.createEventObject&&(createCustomEvent=function(e_name,params){var evt=d.createEventObject();evt.type=evt.propertyName=e_name;evt.detail=params.detail;return evt});createCustomEvent||(createCustomEvent=function(){})}();dispatchEvent=function(e_name,e_data,async){function dispatch(){try{d.dispatchEvent&&!BOOMR.isIE8?d.dispatchEvent(ev):d.fireEvent&&d.fireEvent("onpropertychange",ev)}catch(e){BOOMR.debug("Error when dispatching "+e_name)}}var ev=createCustomEvent(e_name,{detail:e_data});ev&&(async?BOOMR.setImmediate(dispatch):dispatch())};if(void 0!==d.hidden){visibilityState="visibilityState";visibilityChange="visibilitychange"}else if(void 0!==d.mozHidden){visibilityState="mozVisibilityState";visibilityChange="mozvisibilitychange"}else if(void 0!==d.msHidden){visibilityState="msVisibilityState";visibilityChange="msvisibilitychange"}else if(void 0!==d.webkitHidden){visibilityState="webkitVisibilityState";visibilityChange="webkitvisibilitychange"}impl={beacon_url:"",beacon_urls_allowed:[],beacon_type:"AUTO",beacon_auth_key:"Authorization",beacon_auth_token:void 0,site_domain:w.location.hostname.replace(/.*?([^.]+\.[^.]+)\.?$/,"$1").toLowerCase(),user_ip:"",autorun:!0,hasSentPageLoadBeacon:!1,r:void 0,r2:void 0,events:{page_ready:[],page_unload:[],before_unload:[],dom_loaded:[],visibility_changed:[],prerender_to_visible:[],before_beacon:[],onbeaconsent:[],beacon:[],page_load_beacon:[],xhr_load:[],click:[],form_submit:[],config:[],xhr_init:[],spa_init:[],spa_navigation:[],xhr_send:[],xhr_error:[],error:[],xhr_send:[],netinfo:[],rage_click:[]},public_events:{before_beacon:"onBeforeBoomerangBeacon",beacon:"onBoomerangBeacon",onboomerangloaded:"onBoomerangLoaded",onbeaconsent:"onBoomerangBeaconSent"},translate_events:{onbeacon:"beacon",onconfig:"config",onerror:"error",onxhrerror:"xhr_error"},listenerCallbacks:{},vars:{},singleBeaconVars:{},varPriority:{"-1":{},1:{}},errors:{},disabled_plugins:{},localStorageSupported:!1,LOCAL_STORAGE_PREFIX:"_boomr_",xb_handler:function(type){return function(ev){var target;ev||(ev=w.event);ev.target?target=ev.target:ev.srcElement&&(target=ev.srcElement);3===target.nodeType&&(target=target.parentNode);target&&target.nodeName&&"OBJECT"===target.nodeName.toUpperCase()&&"application/x-shockwave-flash"===target.type||impl.fireEvent(type,target)}},clearEvents:function(){var eventName;for(eventName in this.events)this.events.hasOwnProperty(eventName)&&(this.events[eventName]=[])},clearListeners:function(){var type;for(type in impl.listenerCallbacks)if(impl.listenerCallbacks.hasOwnProperty(type))for(;impl.listenerCallbacks[type].length;)BOOMR.utils.removeListener(impl.listenerCallbacks[type][0].el,type,impl.listenerCallbacks[type][0].fn);impl.listenerCallbacks={}},fireEvent:function(e_name,data){var i,handler,handlers,handlersLen;e_name=e_name.toLowerCase();this.translate_events[e_name]&&(e_name=this.translate_events[e_name]);if(this.events.hasOwnProperty(e_name)){this.public_events.hasOwnProperty(e_name)&&dispatchEvent(this.public_events[e_name],data);handlers=this.events[e_name];"before_beacon"!==e_name&&"beacon"!==e_name&&"onbeaconsent"!==e_name&&BOOMR.real_sendBeacon();handlersLen=handlers.length;for(i=0;i<handlersLen;i++)try{handler=handlers[i];handler.fn.call(handler.scope,data,handler.cb_data)}catch(err){BOOMR.addError(err,"fireEvent."+e_name+"<"+i+">")}for(i=0;i<handlersLen;i++)if(handlers[i].once){handlers.splice(i,1);handlersLen--;i--}}},isExitBeacon:function(){return impl.vars["http.initiator"]&&impl.vars["http.initiator"]===BOOMR.constants.BEACON_EXIT_INITIATOR},containsCustomData:function(){return BOOMR.hasVar(BOOMR.constants.BEACON_CUSTOM_DATA)||BOOMR.hasVar(BOOMR.constants.BEACON_CLICK_DATA)},readyCheckPlugins:function(){return!(impl.containsCustomData()||impl.isExitBeacon())},spaNavigation:function(){impl.onloadfired=!0},beaconUrlAllowed:function(url){if(!impl.beacon_urls_allowed||0===impl.beacon_urls_allowed.length)return!0;for(var i=0;i<impl.beacon_urls_allowed.length;i++){if(new RegExp(impl.beacon_urls_allowed[i]).exec(url))return!0}return!1},checkLocalStorageSupport:function(){var name=impl.LOCAL_STORAGE_PREFIX+"clss";impl.localStorageSupported=!1;if(w.JSON&&w.localStorage)try{w.localStorage.setItem(name,name);impl.localStorageSupported=w.localStorage.getItem(name)===name;w.localStorage.removeItem(name)}catch(ignore){impl.localStorageSupported=!1}}};boomr={t_start:BOOMR_start,t_end:void 0,url:"",loadedLate:!1,constants:{BEACON_TYPE_SPAS:["spa","spa_hard","data","clicks","exit","error"],MAX_GET_LENGTH:0,BEACON_CUSTOM_DATA:"custom_data",BEACON_CLICK_DATA:"click_data",BEACON_EXIT_INITIATOR:"exit"},utils:{hasPostMessageSupport:function(){return!(!w.postMessage||"function"!=typeof w.postMessage&&"object"!=typeof w.postMessage)},objectToString:function(o,separator,nest_level){var k,value=[];if(!o||"object"!=typeof o)return o;void 0===separator&&(separator="\n\t");nest_level||(nest_level=0);if(BOOMR.utils.isArray(o)){for(k=0;k<o.length;k++)nest_level>0&&null!==o[k]&&"object"==typeof o[k]?value.push(this.objectToString(o[k],separator+("\n\t"===separator?"\t":""),nest_level-1)):"&"===separator?value.push(encodeURIComponent(o[k])):value.push(o[k]);separator=","}else for(k in o)Object.prototype.hasOwnProperty.call(o,k)&&(nest_level>0&&null!==o[k]&&"object"==typeof o[k]?value.push(encodeURIComponent(k)+"="+this.objectToString(o[k],separator+("\n\t"===separator?"\t":""),nest_level-1)):"&"===separator?value.push(encodeURIComponent(k)+"="+encodeURIComponent(o[k])):value.push(k+"="+o[k]));return value.join(separator)},getCookie:function(name){if(!name)return null;name=" "+name+"=";var i,cookies;cookies=" "+d.cookie+";";if((i=cookies.indexOf(name))>=0){i+=name.length;cookies=cookies.substring(i,cookies.indexOf(";",i)).replace(/^"/,"").replace(/"$/,"");return cookies}},setCookie:function(name,subcookies,max_age){var value,nameval,savedval,c,exp;if(!name||!impl.site_domain||void 0===subcookies){BOOMR.debug("Invalid parameters or site domain: "+name+"/"+subcookies+"/"+impl.site_domain);BOOMR.addVar("nocookie",1);return!1}value=this.objectToString(subcookies,"&");nameval=name+'="'+value+'"';if(nameval.length<500){c=[nameval,"path=/","domain="+impl.site_domain];if("number"==typeof max_age){exp=new Date;exp.setTime(exp.getTime()+1e3*max_age);exp=exp.toGMTString();c.push("expires="+exp)}d.cookie=c.join("; ");savedval=this.getCookie(name);if(value===savedval||void 0===savedval&&"number"==typeof max_age&&max_age<=0)return!0;BOOMR.warn("Saved cookie value doesn't match what we tried to set:\n"+value+"\n"+savedval)}else BOOMR.warn("Cookie too long: "+nameval.length+" "+nameval);BOOMR.addVar("nocookie",1);return!1},getSubCookies:function(cookie){var cookies_a,i,l,kv,gotcookies=!1,cookies={};if(!cookie)return null;if("string"!=typeof cookie){BOOMR.debug("TypeError: cookie is not a string: "+typeof cookie);return null}cookies_a=cookie.split("&");for(i=0,l=cookies_a.length;i<l;i++){kv=cookies_a[i].split("=");if(kv[0]){kv.push("");cookies[decodeURIComponent(kv[0])]=decodeURIComponent(kv[1]);gotcookies=!0}}return gotcookies?cookies:null},removeCookie:function(name){return this.setCookie(name,{},-86400)},getLocalStorage:function(name){var value,data;if(!name||!impl.localStorageSupported)return null;try{value=w.localStorage.getItem(impl.LOCAL_STORAGE_PREFIX+name);if(null===value)return;data=w.JSON.parse(value)}catch(e){BOOMR.warn(e);return null}if(!data||"object"!=typeof data.items){this.removeLocalStorage(name);return null}if(!("number"==typeof data.expires&&BOOMR.now()>=data.expires))return data.items;this.removeLocalStorage(name)},setLocalStorage:function(name,items,max_age){var data,value,savedval;if(!name||!impl.localStorageSupported||"object"!=typeof items)return!1;data={items:items};"number"==typeof max_age&&(data.expires=BOOMR.now()+1e3*max_age);value=w.JSON.stringify(data);if(value.length<5e4){try{w.localStorage.setItem(impl.LOCAL_STORAGE_PREFIX+name,value);savedval=w.localStorage.getItem(impl.LOCAL_STORAGE_PREFIX+name);if(value===savedval)return!0}catch(ignore){}BOOMR.warn("Saved storage value doesn't match what we tried to set:\n"+value+"\n"+savedval)}else BOOMR.warn("Storage items too large: "+value.length+" "+value);return!1},removeLocalStorage:function(name){if(!name||!impl.localStorageSupported)return!1;try{w.localStorage.removeItem(impl.LOCAL_STORAGE_PREFIX+name);return!0}catch(ignore){}return!1},cleanupURL:function(url,urlLimit){if(!url||BOOMR.utils.isArray(url))return"";impl.strip_query_string&&(url=url.replace(/\?.*/,"?qs-redacted"));if(void 0!==urlLimit&&url&&url.length>urlLimit){var qsStart=url.indexOf("?");url=-1!==qsStart&&qsStart<urlLimit?url.substr(0,qsStart)+"?...":url.substr(0,urlLimit-3)+"..."}return url},hashQueryString:function(url,stripHash){if(!url)return url;if(!url.match){BOOMR.addError("TypeError: Not a string","hashQueryString",typeof url);return""}url.match(/^\/\//)&&(url=location.protocol+url);if(!url.match(/^(https?|file):/)){BOOMR.error("Passed in URL is invalid: "+url);return""}stripHash&&(url=url.replace(/#.*/,""));return BOOMR.utils.MD5?url.replace(/\?([^#]*)/,function(m0,m1){return"?"+(m1.length>10?BOOMR.utils.MD5(m1):m1)}):url},pluginConfig:function(o,config,plugin_name,properties){var i,props=0;if(!config||!config[plugin_name])return!1;for(i=0;i<properties.length;i++)if(void 0!==config[plugin_name][properties[i]]){o[properties[i]]=config[plugin_name][properties[i]];props++}return props>0},arrayFilter:function(array,predicate){var result=[];if(!(this.isArray(array)||array&&"number"==typeof array.length)||"function"!=typeof predicate)return result;if("function"==typeof array.filter)result=array.filter(predicate);else for(var value,index=-1,length=array.length;++index<length;){value=array[index];predicate(value,index,array)&&(result[result.length]=value)}return result},arrayFind:function(array,predicate){if((this.isArray(array)||array&&"number"==typeof array.length)&&"function"==typeof predicate){if("function"==typeof array.find)return array.find(predicate);for(var value,index=-1,length=array.length;++index<length;){value=array[index];if(predicate(value,index,array))return value}}},isMutationObserverSupported:function(){return!(w&&w.navigator&&w.navigator.userAgent&&w.navigator.userAgent.match(/Trident.*rv[ :]*11\./))&&w&&w.MutationObserver&&"function"==typeof w.MutationObserver},addObserver:function(el,config,timeout,callback,callback_data,callback_ctx){function done(mutations){var run_again=!1;if(o.timer){clearTimeout(o.timer);o.timer=null}if(callback){run_again=callback.call(callback_ctx,mutations,callback_data);run_again||(callback=null)}if(!run_again&&o.observer){o.observer.disconnect();o.observer=null}"number"==typeof run_again&&run_again>0&&(o.timer=setTimeout(done,run_again))}var o={observer:null,timer:null};if(!this.isMutationObserverSupported()||!callback||!el)return null;o.observer=new BOOMR.window.MutationObserver(done);timeout&&(o.timer=setTimeout(done,o.timeout));o.observer.observe(el,config);return o},addListener:function(el,type,fn,passive){var opts=!1;if(el.addEventListener){passive&&BOOMR.browser.supportsPassive()&&(opts={capture:!1,passive:!0});el.addEventListener(type,fn,opts)}else el.attachEvent&&el.attachEvent("on"+type,fn);impl.listenerCallbacks[type]=impl.listenerCallbacks[type]||[];impl.listenerCallbacks[type].push({el:el,fn:fn})},removeListener:function(el,type,fn){var i;el.removeEventListener?el.removeEventListener(type,fn,!1):el.detachEvent&&el.detachEvent("on"+type,fn);if(impl.listenerCallbacks.hasOwnProperty(type))for(var i=0;i<impl.listenerCallbacks[type].length;i++)if(fn===impl.listenerCallbacks[type][i].fn&&el===impl.listenerCallbacks[type][i].el){impl.listenerCallbacks[type].splice(i,1);return}},isArray:function(ary){return"[object Array]"===Object.prototype.toString.call(ary)},inArray:function(val,ary){var i;if(void 0===val||void 0===ary||!ary.length)return!1;for(i=0;i<ary.length;i++)if(ary[i]===val)return!0;return!1},getQueryParamValue:function(param,url){var l,params,i,kv;if(!param)return null;if("string"==typeof url){l=BOOMR.window.document.createElement("a");l.href=url}else l="object"==typeof url&&"string"==typeof url.search?url:BOOMR.window.location;params=l.search.slice(1).split(/&/);for(i=0;i<params.length;i++)if(params[i]){kv=params[i].split("=");if(kv.length&&kv[0]===param)return decodeURIComponent(kv[1].replace(/\+/g," "))}return null},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0;return("x"===c?r:3&r|8).toString(16)})},generateId:function(chars){return"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".substr(0,chars||40).replace(/x/g,function(c){var c=(Math.random()||.01).toString(36);return"0"===c?"0":c.substr(2,1)})},serializeForUrl:function(value){if(window.JSON)return JSON.stringify(value);BOOMR.debug("JSON is not supported");return""},getMyURL:function(){var stack,BOOMR_script=document.currentScript||document.getElementById("boomr-if-as")||document.getElementById("boomr-scr-as");if(BOOMR_script)return BOOMR_script.src;var i,scripts=document.getElementsByTagName("script");for(i=scripts.length;i--;)if("interactive"===scripts[i].readyState)return scripts[i].src;try{throw new Error}catch(e){if("stack"in e){stack=this.arrayFilter(e.stack.split(/\n/),function(l){return l.match(/https?:\/\//)});if(stack&&stack.length)return stack[0].replace(/.*(https?:\/\/.+?)(:\d+)+\D*$/m,"$1")}}return""},scroll:function(){var supportPageOffset=void 0!==w.pageXOffset,isCSS1Compat="CSS1Compat"===(w.document.compatMode||""),ret={x:0,y:0};if(supportPageOffset)if("function"==typeof w.pageXOffset){ret.x=w.pageXOffset();ret.y=w.pageYOffset()}else{ret.x=w.pageXOffset;ret.y=w.pageYOffset}else if(isCSS1Compat){ret.x=w.document.documentElement.scrollLeft;ret.y=w.document.documentElement.scrollTop}else{ret.x=w.document.body.scrollLeft;ret.y=w.document.body.scrollTop}"number"==typeof ret.sx&&(ret.sx=Math.round(ret.sx));"number"==typeof ret.sy&&(ret.sy=Math.round(ret.sy));return ret},windowHeight:function(){return w.innerHeight||w.document.documentElement.clientHeight||w.document.body.clientHeight},windowWidth:function(){return w.innerWidth||w.document.documentElement.clientWidth||w.document.body.clientWidth}},browser:{results:{},supportsPassive:function(){if(void 0===BOOMR.browser.results.supportsPassive){BOOMR.browser.results.supportsPassive=!1;if(!Object.defineProperty)return!1;try{var opts=Object.defineProperty({},"passive",{get:function(){BOOMR.browser.results.supportsPassive=!0}});window.addEventListener("test",null,opts)}catch(e){}}return BOOMR.browser.results.supportsPassive}},init:function(config){var i,k,properties=["autorun","beacon_auth_key","beacon_auth_token","beacon_url","beacon_type","site_domain","strip_query_string","user_ip"];BOOMR_check_doc_domain();config||(config={});void 0!==config.log&&(this.log=config.log);this.log||(this.log=function(){});if(!this.pageId){this.pageId=BOOMR.utils.generateId(8);BOOMR.debug("Generated PageID: "+this.pageId)}if(config.primary&&impl.handlers_attached)return this;void 0!==config.autorun&&(impl.autorun=config.autorun);for(k in this.plugins)if(this.plugins.hasOwnProperty(k)){if(config[k]&&config[k].hasOwnProperty("enabled")&&!1===config[k].enabled){impl.disabled_plugins[k]=1;"function"==typeof this.plugins[k].disable&&this.plugins[k].disable();continue}if(impl.disabled_plugins[k]){if(!config[k]||!config[k].hasOwnProperty("enabled")||!0!==config[k].enabled)continue;"function"==typeof this.plugins[k].enable&&this.plugins[k].enable();delete impl.disabled_plugins[k]}if("function"==typeof this.plugins[k].init)try{this.plugins[k].init(config)}catch(err){BOOMR.addError(err,k+".init")}}for(i=0;i<properties.length;i++)void 0!==config[properties[i]]&&(impl[properties[i]]=config[properties[i]]);if(impl.handlers_attached)return this;if(!impl.onloadfired&&(void 0===config.autorun||!1!==config.autorun)){BOOMR.hasBrowserOnloadFired()&&(BOOMR.loadedLate=!0);BOOMR.attach_page_ready(BOOMR.page_ready_autorun)}BOOMR.utils.addListener(w,"DOMContentLoaded",function(){impl.fireEvent("dom_loaded")});BOOMR.fireEvent("config",config);BOOMR.subscribe("config",function(beaconConfig){beaconConfig.beacon_url&&(impl.beacon_url=beaconConfig.beacon_url)});BOOMR.subscribe("spa_navigation",impl.spaNavigation,null,impl);!function(){var forms,iterator;if(void 0!==visibilityChange){BOOMR.utils.addListener(d,visibilityChange,function(){impl.fireEvent("visibility_changed")});impl.lastVisibilityState=BOOMR.visibilityState();BOOMR.subscribe("visibility_changed",function(){var visState=BOOMR.visibilityState();BOOMR.lastVisibilityEvent[visState]=BOOMR.now();BOOMR.debug("Visibility changed from "+impl.lastVisibilityState+" to "+visState);if("prerender"===impl.lastVisibilityState&&"prerender"!==visState){BOOMR.addVar("vis.pre","1");impl.fireEvent("prerender_to_visible")}impl.lastVisibilityState=visState})}BOOMR.utils.addListener(d,"mouseup",impl.xb_handler("click"));forms=d.getElementsByTagName("form");for(iterator=0;iterator<forms.length;iterator++)BOOMR.utils.addListener(forms[iterator],"submit",impl.xb_handler("form_submit"));w.onpagehide||null===w.onpagehide||BOOMR.utils.addListener(w,"unload",function(){BOOMR.window=w=null})}();impl.handlers_attached=!0;return this},attach_page_ready:function(cb){BOOMR.hasBrowserOnloadFired()?this.setImmediate(cb,null,null,BOOMR):w.onpagehide||null===w.onpagehide?BOOMR.utils.addListener(w,"pageshow",cb):BOOMR.utils.addListener(w,"load",cb)},page_ready_autorun:function(ev){impl.autorun&&BOOMR.page_ready(ev,!0)},page_ready:function(ev,auto){var tm_page_ready;if(!auto&&"number"==typeof ev){tm_page_ready=ev;ev=null}ev||(ev=w.event);ev||(ev={name:"load"});if(auto){if("number"==typeof w.BOOMR_page_ready){ev.timing=ev.timing||{};ev.timing.loadEventEnd=w.BOOMR_page_ready;BOOMR.addVar("pr",1,!0)}}else{ev.timing=ev.timing||{};tm_page_ready?ev.timing.loadEventEnd=tm_page_ready:"number"==typeof w.BOOMR_page_ready?ev.timing.loadEventEnd=w.BOOMR_page_ready:ev.timing.loadEventEnd=BOOMR.now();BOOMR.addVar("pr",1,!0)}if(impl.onloadfired)return this;impl.fireEvent("page_ready",ev);impl.onloadfired=!0;return this},hasBrowserOnloadFired:function(){var p=BOOMR.getPerformance();return d.readyState&&"complete"===d.readyState||p&&p.timing&&p.timing.loadEventStart>0||w.BOOMR_onload>0},onloadFired:function(){return impl.onloadfired},setImmediate:function(fn,data,cb_data,cb_scope){var cb,cstack;cb=function(){fn.call(cb_scope||null,data,cb_data||{},cstack);cb=null};w.requestIdleCallback?w.requestIdleCallback(cb,{timeout:1e3}):w.setImmediate?w.setImmediate(cb):setTimeout(cb,10)},now:function(){return Date.now||function(){return(new Date).getTime()}}(),getPerformance:function(){try{if(BOOMR.window)return"performance"in BOOMR.window&&BOOMR.window.performance?BOOMR.window.performance:BOOMR.window.msPerformance||BOOMR.window.webkitPerformance||BOOMR.window.mozPerformance}catch(ignore){}},hrNow:function(){var now,navigationStart,p=BOOMR.getPerformance();if(p&&p.now)now=p.now();else{navigationStart=BOOMR.plugins.RT&&BOOMR.plugins.RT.navigationStart&&BOOMR.plugins.RT.navigationStart()||BOOMR.t_lstart||BOOMR.t_start;now=BOOMR.now()-navigationStart}return now},visibilityState:void 0===visibilityState?function(){return"visible"}:function(){return d[visibilityState]},lastVisibilityEvent:{},registerEvent:function(e_name){if(impl.events.hasOwnProperty(e_name))return this;impl.events[e_name]=[];return this},disable:function(){impl.clearEvents();impl.clearListeners()},fireEvent:function(e_name,data){return impl.fireEvent(e_name,data)},subscribe:function(e_name,fn,cb_data,cb_scope,once){var i,handler,ev;e_name=e_name.toLowerCase();impl.translate_events[e_name]&&(e_name=impl.translate_events[e_name]);impl.events.hasOwnProperty(e_name)||(impl.events[e_name]=[]);ev=impl.events[e_name];for(i=0;i<ev.length;i++){handler=ev[i];if(handler&&handler.fn===fn&&handler.cb_data===cb_data&&handler.scope===cb_scope)return this}ev.push({fn:fn,cb_data:cb_data||{},scope:cb_scope||null,once:once||!1});"page_ready"===e_name&&impl.onloadfired&&impl.autorun&&this.setImmediate(fn,null,cb_data,cb_scope);"page_unload"!==e_name&&"before_unload"!==e_name||function(){var unload_handler,evt_idx=ev.length;unload_handler=function(evt){fn&&fn.call(cb_scope,evt||w.event,cb_data);if("page_unload"===e_name&&evt_idx===impl.events[e_name].length){BOOMR.addVar("http.initiator",BOOMR.constants.BEACON_EXIT_INITIATOR);BOOMR.real_sendBeacon()}};"page_unload"===e_name&&(w.onpagehide||null===w.onpagehide?BOOMR.utils.addListener(w,"pagehide",unload_handler):BOOMR.utils.addListener(w,"unload",unload_handler));BOOMR.utils.addListener(w,"beforeunload",unload_handler)}();return this},addError:function(err,src,extra){var str,E=BOOMR.plugins.Errors;if(E&&E.is_supported())if("string"==typeof err)E.send({message:err,extra:extra,functionName:src,noStack:!0},E.VIA_APP,E.SOURCE_BOOMERANG);else{"string"==typeof src&&(err.functionName=src);void 0!==extra&&(err.extra=extra);E.send(err,E.VIA_APP,E.SOURCE_BOOMERANG)}else{if("string"!=typeof err){str=String(err);str.match(/^\[object/)&&(str=err.name+": "+(err.description||err.message).replace(/\r\n$/,""));err=str}void 0!==src&&(err="["+src+":"+BOOMR.now()+"] "+err);extra&&(err+=":: "+extra);impl.errors[err]?impl.errors[err]++:impl.errors[err]=1}},isCrossOriginError:function(err){return"SecurityError"===err.name||"TypeError"===err.name&&"Permission denied"===err.message||"Error"===err.name&&err.message&&err.message.match(/^(Permission|Access is) denied/)},addVar:function(name,value,singleBeacon){if("string"==typeof name)impl.vars[name]=value;else if("object"==typeof name){var k,o=name;for(k in o)o.hasOwnProperty(k)&&(impl.vars[k]=o[k])}singleBeacon&&(impl.singleBeaconVars[name]=1);return this},appendVar:function(name,value){var existing=BOOMR.getVar(name)||"";existing&&(existing+=",");BOOMR.addVar(name,existing+value);return this},removeVar:function(arg0){var i,params;if(!arguments.length)return this;params=1===arguments.length&&BOOMR.utils.isArray(arg0)?arg0:arguments;for(i=0;i<params.length;i++)impl.vars.hasOwnProperty(params[i])&&delete impl.vars[params[i]];return this},hasVar:function(name){return impl.vars.hasOwnProperty(name)},getVar:function(name){return impl.vars[name]},setVarPriority:function(name,pri){if("number"!=typeof pri||1!==Math.abs(pri))return this;impl.varPriority[pri][name]=1;return this},setReferrer:function(r,r2){impl.r=r;impl.r2=r2&&r!==r2?r2:void 0},requestStart:function(name){var t_start=BOOMR.now();BOOMR.plugins.RT.startTimer("xhr_"+name,t_start);return{loaded:function(data){BOOMR.responseEnd(name,t_start,data)}}},readyToSend:function(){var plugin;for(plugin in this.plugins)if(this.plugins.hasOwnProperty(plugin)){if(impl.disabled_plugins[plugin])continue;if("function"==typeof this.plugins[plugin].readyToSend&&!1===this.plugins[plugin].readyToSend()){BOOMR.debug("Plugin "+plugin+" is not ready to send");return!1}}return!0},responseEnd:function(name,t_start,data,t_end){t_start="number"==typeof t_start?t_start:BOOMR.now();t_end="number"==typeof t_end?t_end:BOOMR.now();if(BOOMR.readyToSend())if(BOOMR.hasSentPageLoadBeacon()||BOOMR.utils.inArray(name.initiator,BOOMR.constants.BEACON_TYPE_SPAS))if("object"==typeof name){if(!name.url){BOOMR.debug("BOOMR.responseEnd: First argument must have a url property if it's an object");return}impl.fireEvent("xhr_load",name)}else{BOOMR.real_sendBeacon();BOOMR.addVar("xhr.pg",name);BOOMR.plugins.RT.startTimer("xhr_"+name,t_start);impl.fireEvent("xhr_load",{name:"xhr_"+name,data:data,timing:{loadEventEnd:t_end}})}else BOOMR.subscribe("page_load_beacon",function(){BOOMR.responseEnd(name,t_start,data,t_end)},null,BOOMR,!0);else{BOOMR.debug("Attempted to call responseEnd before all plugins were Ready to Send, trying again...");setTimeout(function(){BOOMR.responseEnd(name,t_start,data,t_end)},1e3)}},uninstrumentXHR:function(){},instrumentXHR:function(){},sendBeacon:function(beacon_url_override){beacon_url_override&&(impl.beacon_url_override=beacon_url_override);if(!impl.beaconQueued){impl.beaconQueued=!0;BOOMR.setImmediate(BOOMR.real_sendBeacon,null,null,BOOMR)}return!0},real_sendBeacon:function(){var k,_if,errors=[],varsSent={};if(!impl.beaconQueued)return!1;impl.beaconQueued=!1;BOOMR.debug("Checking if we can send beacon");if(impl.readyCheckPlugins())for(k in this.plugins)if(this.plugins.hasOwnProperty(k)){if(impl.disabled_plugins[k])continue;if(!this.plugins[k].is_complete(impl.vars)){BOOMR.debug("Plugin "+k+" is not complete, deferring beacon send");return!1}}if(!(window&&window.Image&&window.navigator&&BOOMR.window)){BOOMR.debug("DOM not fully available, not sending a beacon");return!1}var isSPA=BOOMR.utils.inArray(impl.vars["http.initiator"],BOOMR.constants.BEACON_TYPE_SPAS),isPageLoad=void 0===impl.vars["http.initiator"]||isSPA;impl.vars.pgu||(impl.vars.pgu=isSPA?d.URL:d.URL.replace(/#.*/,""));impl.vars.pgu=BOOMR.utils.cleanupURL(impl.vars.pgu);impl.vars.u&&!isSPA||(impl.vars.u=impl.vars.pgu);impl.vars.pgu===impl.vars.u&&delete impl.vars.pgu;impl.r?impl.vars.r=BOOMR.utils.cleanupURL(impl.r):delete impl.vars.r;impl.r2?impl.vars.r2=BOOMR.utils.cleanupURL(impl.r2):delete impl.vars.r2;impl.vars.v=BOOMR.version;if(BOOMR.visibilityState()){impl.vars["vis.st"]=BOOMR.visibilityState();BOOMR.lastVisibilityEvent.visible&&(impl.vars["vis.lv"]=BOOMR.now()-BOOMR.lastVisibilityEvent.visible);BOOMR.lastVisibilityEvent.hidden&&(impl.vars["vis.lh"]=BOOMR.now()-BOOMR.lastVisibilityEvent.hidden)}impl.vars["ua.plt"]=navigator.platform;impl.vars["ua.vnd"]=navigator.vendor;this.pageId&&(impl.vars.pid=this.pageId);if(w!==window){_if="if";impl.vars[_if]=""}for(k in impl.errors)impl.errors.hasOwnProperty(k)&&errors.push(k+(impl.errors[k]>1?" (*"+impl.errors[k]+")":""));errors.length>0&&(impl.vars.errors=errors.join("\n"));impl.errors={};impl.fireEvent("before_beacon",impl.vars);for(k in impl.vars)impl.vars.hasOwnProperty(k)&&(varsSent[k]=impl.vars[k]);BOOMR.removeVar("qt");for(var singleVarName in impl.singleBeaconVars)impl.singleBeaconVars.hasOwnProperty(singleVarName)&&BOOMR.removeVar(singleVarName);impl.singleBeaconVars={};if(!impl.hasSentPageLoadBeacon&&isPageLoad){impl.hasSentPageLoadBeacon=!0;BOOMR.setImmediate(function(){impl.fireEvent("page_load_beacon",varsSent)})}BOOMR.sendBeaconData(varsSent);return!0},hasSentPageLoadBeacon:function(){return impl.hasSentPageLoadBeacon},sendBeaconData:function(data){var params,paramsJoined,url,img,xhr,urlFirst=[],urlLast=[],useImg=!0;BOOMR.debug("Ready to send beacon: "+BOOMR.utils.objectToString(data));impl.beacon_url=impl.beacon_url_override||impl.beacon_url;if(!impl.beacon_url){BOOMR.debug("No beacon URL, so skipping.");return!1}if(!impl.beaconUrlAllowed(impl.beacon_url)){BOOMR.debug("Beacon URL not allowed: "+impl.beacon_url);return!1}if(0===data.length)return!1;impl.fireEvent("beacon",data);urlFirst=this.getVarsOfPriority(data,-1);urlLast=this.getVarsOfPriority(data,1);params=urlFirst.concat(this.getVarsOfPriority(data,0),urlLast);paramsJoined=params.join("&");url=impl.beacon_url+(impl.beacon_url.indexOf("?")>-1?"&":"?")+paramsJoined;("POST"===impl.beacon_type||url.length>BOOMR.constants.MAX_GET_LENGTH)&&(useImg=!1);if(w&&w.navigator&&"function"==typeof w.navigator.sendBeacon&&"function"==typeof w.Blob){var blobData=new w.Blob([paramsJoined+"&sb=1"],{type:"application/x-www-form-urlencoded"});if(w.navigator.sendBeacon(impl.beacon_url,blobData)){impl.fireEvent("onbeaconsent",data);return!0}}BOOMR.orig_XMLHttpRequest||w&&w.XMLHttpRequest||(useImg=!0);if(useImg){try{img=new Image}catch(e){BOOMR.debug("Image is not a constructor, not sending a beacon");return!1}img.src=url}else{xhr=new(BOOMR.window.orig_XMLHttpRequest||BOOMR.orig_XMLHttpRequest||BOOMR.window.XMLHttpRequest);try{this.sendXhrPostBeacon(xhr,paramsJoined)}catch(e){xhr=new BOOMR.boomerang_frame.XMLHttpRequest;this.sendXhrPostBeacon(xhr,paramsJoined)}}impl.containsCustomData()&&BOOMR.removeVar(BOOMR.constants.BEACON_CUSTOM_DATA);impl.fireEvent("onbeaconsent",data);return!0},hasSentPageLoadBeacon:function(){return impl.hasSentPageLoadBeacon},sendXhrPostBeacon:function(xhr,paramsJoined){xhr.open("POST",impl.beacon_url);xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");if(void 0!==impl.beacon_auth_token){void 0===impl.beacon_auth_key&&(impl.beacon_auth_key="Authorization");xhr.setRequestHeader(impl.beacon_auth_key,impl.beacon_auth_token)}xhr.send(paramsJoined)},getVarsOfPriority:function(vars,pri){var name,url=[];if(0!==pri){for(name in impl.varPriority[pri])if(impl.varPriority[pri].hasOwnProperty(name)&&vars.hasOwnProperty(name)){url.push(this.getUriEncodedVar(name,vars[name]));delete vars[name]}}else for(name in vars)vars.hasOwnProperty(name)&&url.push(this.getUriEncodedVar(name,vars[name]));return url},getUriEncodedVar:function(name,value){void 0!==value&&null!==value||(value="");"object"==typeof value&&(value=BOOMR.utils.serializeForUrl(value));return encodeURIComponent(name)+"="+encodeURIComponent(value)},getResourceTiming:function(url,sort){var entries,p=BOOMR.getPerformance();try{if(p&&"function"==typeof p.getEntriesByName){entries=p.getEntriesByName(url);if(entries&&entries.length){"function"==typeof sort&&entries.sort(sort);return entries[entries.length-1]}}}catch(ignore){}},sendCustomData:function(customData){BOOMR.addVar({custom_data:JSON.stringify(customData)});BOOMR.hasVar("http.initiator")?impl.vars["http.initiator"]="data":BOOMR.addVar("http.initiator","data");BOOMR.sendBeacon()}};boomr.url=boomr.utils.getMyURL();delete BOOMR_start;if("number"==typeof BOOMR_lstart){boomr.t_lstart=BOOMR_lstart;delete BOOMR_lstart}else"number"==typeof BOOMR.window.BOOMR_lstart&&(boomr.t_lstart=BOOMR.window.BOOMR_lstart);"number"==typeof BOOMR.window.BOOMR_onload&&(boomr.t_onload=BOOMR.window.BOOMR_onload);!function(){var make_logger;"object"==typeof console&&void 0!==console.log?boomr.log=function(m,l,s){console.log("("+BOOMR.now()+") {"+BOOMR.pageId+"}: "+s+": ["+l+"] "+m)}:boomr.log=function(){};make_logger=function(l){return function(m,s){this.log(m,l,"boomerang"+(s?"."+s:""));return this}};boomr.debug=make_logger("debug");boomr.info=make_logger("info");boomr.warn=make_logger("warn");boomr.error=make_logger("error")}();try{var p=boomr.getPerformance();p&&"function"==typeof p.now&&/\[native code\]/.test(String(p.now))&&p.timing&&p.timing.navigationStart&&(boomr.now=function(){
return Math.round(p.now()+p.timing.navigationStart)})}catch(ignore){}impl.checkLocalStorageSupport();!function(){var ident;for(ident in boomr)boomr.hasOwnProperty(ident)&&(BOOMR[ident]=boomr[ident]);BOOMR.xhr_excludes||(BOOMR.xhr_excludes={});BOOMR.xhr_body_excludes||(BOOMR.xhr_body_excludes=[])}();dispatchEvent("onBoomerangLoaded",{BOOMR:BOOMR},!0)}}(window);!function(){function debug(msg){BOOMR.debug(msg,"Continuity")}function compressJson(data){var utc=window.UserTimingCompression||BOOMR.window.UserTimingCompression;return utc?utc.jsUrl(data):window.JSON?JSON.stringify(data):""}function compressBucketLog(type,backfill,dataSet,sinceBucket,endBucket){var i,dupes,valStr,nextVal,wroteSomething,out="",val=0;if(!dataSet||!BOOMR.utils.Compression)return"";if(0===dataSet.length)return"";if(backfill){void 0===dataSet[sinceBucket]&&(dataSet[sinceBucket]=0);for(i=sinceBucket+1;i<=endBucket;i++)void 0===dataSet[i]&&(dataSet[i]=dataSet[i-1])}for(i=sinceBucket;i<=endBucket;i++){val="number"!=typeof dataSet[i]||isNaN(dataSet[i])?0:dataSet[i];type===COMPRESS_MODE_SMALL_NUMBERS?valStr=val<=63?BASE64_NUMBER.charAt(val):LARGE_NUMBER_WRAP+val.toString(36)+LARGE_NUMBER_WRAP:type===COMPRESS_MODE_LARGE_NUMBERS?valStr=val.toString(36):type===COMPRESS_MODE_PERCENT&&(valStr=val<99?val<=9?"0"+Math.max(val,0):val:"__");if(i+3<=endBucket&&(dataSet[i+1]===val||0===val&&void 0===dataSet[i+1])&&(dataSet[i+2]===val||0===val&&void 0===dataSet[i+2])&&(dataSet[i+3]===val||0===val&&void 0===dataSet[i+3])){dupes=1;for(;i<endBucket&&(dataSet[i+1]===val||0===val&&void 0===dataSet[i+1]);){dupes++;i++}nextVal="*"+dupes.toString(36)+"*"+valStr}else nextVal=valStr;if(0!==val||i!==endBucket){type===COMPRESS_MODE_LARGE_NUMBERS&&wroteSomething&&(out+=",");wroteSomething=!0;out+=nextVal}}return wroteSomething?type.toString()+out:""}if(!BOOMR.plugins.Continuity){var COLLECTION_INTERVAL=100,TIME_TO_INTERACTIVE_WAIT_POLL_PERIOD=500,COMPRESS_MODE_SMALL_NUMBERS=0,COMPRESS_MODE_LARGE_NUMBERS=1,COMPRESS_MODE_PERCENT=2,LOG_TYPE_SCROLL=0,LOG_TYPE_CLICK=1,LOG_TYPE_MOUSE=2,LOG_TYPE_KEY=3,LOG_TYPE_VIS=4,LOG_TYPE_ORIENTATION=5,BASE64_NUMBER="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_",LARGE_NUMBER_WRAP=".",p=BOOMR.getPerformance(),externalMetrics={},epoch=p&&p.timing&&p.timing.navigationStart?p.timing.navigationStart:BOOMR.now(),Timeline=function(startTime){function register(type,compressMode,backfillLast){data[type]||(data[type]=[]);dataOptions[type]={compressMode:compressMode||COMPRESS_MODE_SMALL_NUMBERS,backfillLast:backfillLast}}function getTimeBucket(){return Math.floor((BOOMR.now()-startTime)/COLLECTION_INTERVAL)}function set(type,value,bucket){void 0===bucket&&(bucket=getTimeBucket());data[type]&&(data[type][bucket]=value)}function increment(type,value,bucket){void 0===bucket&&(bucket=getTimeBucket());void 0===value&&(value=1);if(data[type]){data[type][bucket]||(data[type][bucket]=0);data[type][bucket]+=value}}function log(type,bucket,val){void 0===bucket&&(bucket=getTimeBucket());dataLog.push({type:type,time:bucket,val:val});dataLog.length>impl.logMaxEntries&&Array.prototype.splice.call(dataLog,0,dataLog.length-impl.logMaxEntries)}function getStats(type,since){var val,count=0,total=0,min=1/0,max=0,sinceBucket=Math.floor((since-startTime)/COLLECTION_INTERVAL);if(!data[type])return 0;for(var bucket in data[type]){bucket=parseInt(bucket,10);if(bucket>=sinceBucket&&data[type].hasOwnProperty(bucket)){val=data[type][bucket];count++;total+=val;min=Math.min(min,val);max=Math.max(max,val)}}return{total:total,count:count,min:min,max:max}}function determineImageLoadTime(selector){var combinedSelector,elements,i,j,src,entries,latestTs=0;if(!BOOMR.window||!BOOMR.window.document||"function"!=typeof BOOMR.window.document.querySelectorAll)return 0;if(!p||"function"!=typeof p.getEntriesByType)return 0;combinedSelector=selector+", "+selector+" * img";elements=BOOMR.window.document.querySelectorAll(combinedSelector);if(elements&&elements.length)for(i=0;i<elements.length;i++){src=elements[i].src;if(src){entries=p.getEntriesByName(src);if(entries&&entries.length)for(j=0;j<entries.length;j++)latestTs=Math.max(latestTs,entries[j].responseEnd)}}return latestTs?Math.floor(latestTs+epoch):0}function determineVisuallyReady(){var latestTs=0;if(impl.ttiWaitForFrameworkReady){if(!impl.frameworkReady)return;latestTs=impl.frameworkReady}if(BOOMR.plugins.PaintTiming&&BOOMR.plugins.PaintTiming.is_supported()&&p&&p.timeOrigin){var fp=BOOMR.plugins.PaintTiming.getTimingFor("first-contentful-paint");fp||(fp=BOOMR.plugins.PaintTiming.getTimingFor("first-paint"));fp&&(latestTs=Math.max(latestTs,Math.round(fp+p.timeOrigin)))}else if(p&&p.timing&&p.timing.msFirstPaint)latestTs=Math.max(latestTs,p.timing.msFirstPaint);else if(BOOMR.window&&BOOMR.window.chrome&&"function"==typeof BOOMR.window.chrome.loadTimes){var loadTimes=BOOMR.window.chrome.loadTimes();loadTimes&&loadTimes.firstPaintTime&&(latestTs=Math.max(latestTs,1e3*loadTimes.firstPaintTime))}p&&p.timing&&p.timing.domContentLoadedEventEnd&&(latestTs=Math.max(latestTs,p.timing.domContentLoadedEventEnd));if(impl.ttiWaitForHeroImages){heroImagesReady=determineImageLoadTime(impl.ttiWaitForHeroImages);heroImagesReady&&(latestTs=Math.max(latestTs,heroImagesReady))}return latestTs}function addCompressedLogToBeacon(){for(var val="",i=0;i<dataLog.length;i++){var evt=dataLog[i];0!==i&&(val+="|");val+=evt.type;val+=Math.round(evt.time-epoch).toString(36);for(var param in evt.val)if(evt.val.hasOwnProperty(param)){val+=","+param;"number"==typeof evt.val[param]?val+=evt.val[param].toString(36):val+=evt.val[param]}}""!==val&&impl.addToBeacon("c.l",val)}function getCompressedBucketLogFor(type,since){return compressBucketLog(dataOptions[type].compressMode,dataOptions[type].backfillLast,data[type],0!==since?Math.floor((since-startTime)/COLLECTION_INTERVAL):0,getTimeBucket())}function addCompressedTimelineToBeacon(since){var type,compressedLog;for(type in data)if(data.hasOwnProperty(type)){compressedLog=getCompressedBucketLogFor(type,since);""!==compressedLog&&impl.addToBeacon("c.t."+type,compressedLog)}}function analyze(timeOfLastBeacon){var endBucket=getTimeBucket(),j=0,idleIntervals=0;impl.sendLog&&void 0!==timeOfLastBeacon&&addCompressedLogToBeacon();impl.sendTimeline&&void 0!==timeOfLastBeacon&&addCompressedTimelineToBeacon(timeOfLastBeacon);if(!tti){if(!visuallyReady){visuallyReady=determineVisuallyReady();if(!visuallyReady)return}impl.addToBeacon("c.tti.vr",externalMetrics.timeToVisuallyReady());impl.addToBeacon("c.tti.fr",externalMetrics.timeToFrameworkReady());impl.addToBeacon("c.tti.hi",externalMetrics.timeToHeroImagesReady());if(data.longtask||data.fps||data.busy){var startBucket=Math.floor((visuallyReady-startTime)/COLLECTION_INTERVAL);for(j=startBucket;j<=endBucket;j++)if(data.longtask&&data.longtask[j])idleIntervals=0;else if(data.fps&&(!data.fps[j]||data.fps[j]<TIME_TO_INTERACTIVE_MIN_FPS_PER_INTERVAL))idleIntervals=0;else if(data.busy&&data.busy[j]>TIME_TO_INTERACTIVE_MAX_PAGE_BUSY)idleIntervals=0;else if(data.interdly&&data.interdly[j])idleIntervals=0;else{idleIntervals++;if(idleIntervals>=TIME_TO_INTERACTIVE_IDLE_INTERVALS){tti=startTime+(j-TIME_TO_INTERACTIVE_IDLE_INTERVALS)*COLLECTION_INTERVAL;tti=Math.max(tti,visuallyReady);break}}tti>0&&impl.addToBeacon("c.tti",externalMetrics.timeToInteractive())}}}function stop(){data={};dataLog=[]}function onBeacon(){for(var type in data)data.hasOwnProperty(type)&&(data[type]=[]);dataLog=[]}var TIME_TO_INTERACTIVE_IDLE_INTERVALS=5,TIME_TO_INTERACTIVE_MIN_FPS=20,TIME_TO_INTERACTIVE_MIN_FPS_PER_INTERVAL=TIME_TO_INTERACTIVE_MIN_FPS/(1e3/COLLECTION_INTERVAL),TIME_TO_INTERACTIVE_MAX_PAGE_BUSY=50,data={},dataOptions={},dataLog=[],tti=0,visuallyReady=0,heroImagesReady=0;BOOMR.fpsLog&&BOOMR.fpsLog.length&&(startTime=BOOMR.fpsLog[0]+epoch);externalMetrics.timeToInteractive=function(){if(tti)return tti-epoch};externalMetrics.timeToVisuallyReady=function(){if(visuallyReady)return visuallyReady-epoch};externalMetrics.timeToHeroImagesReady=function(){if(impl.ttiWaitForHeroImages&&heroImagesReady)return heroImagesReady-epoch};externalMetrics.timeToFrameworkReady=function(){if(impl.ttiWaitForFrameworkReady&&impl.frameworkReady)return impl.frameworkReady-epoch};externalMetrics.log=function(){return dataLog};return{register:register,set:set,log:log,increment:increment,getTimeBucket:getTimeBucket,getStats:getStats,analyze:analyze,stop:stop,onBeacon:onBeacon}},LongTaskMonitor=function(w,t){function onPerformanceObserver(list){var entries,i;if(enabled){entries=list.getEntries();Array.prototype.push.apply(longTasks,entries);for(i=0;i<entries.length;i++)longTasksTime+=entries[i].duration;t.increment("longtask",entries.length)}}function getTasks(){return longTasks}function clearTasks(){longTasks=[];longTasksTime=0}function analyze(startTime){var i,j,task,obj,attr,objs=[],attrs=[];if(0!==longTasks.length){for(i=0;i<longTasks.length;i++){task=longTasks[i];obj={s:Math.round(task.startTime).toString(36),d:Math.round(task.duration).toString(36),n:ATTRIBUTION_TYPES[task.name]?ATTRIBUTION_TYPES[task.name]:0};attrs=[];for(j=0;j<task.attribution.length;j++){attr=task.attribution[j];if("script"!==attr.name||"iframe"!==attr.containerType||attr.containerName||attr.containerId||attr.containerSrc){var containerName=attr.containerName?attr.containerName:void 0,containerId=attr.containerId?attr.containerId:void 0;containerName===containerId&&(containerName=void 0);var containerSrc=void 0===containerId?attr.containerSrc:void 0;attrs.push({a:CULPRIT_ATTRIBUTION_NAMES[attr.name]?CULPRIT_ATTRIBUTION_NAMES[attr.name]:0,t:CULPRIT_TYPES[attr.containerType]?CULPRIT_TYPES[attr.containerType]:0,n:containerName,i:containerId,s:containerSrc})}}attrs.length>0&&(obj.a=attrs);objs.push(obj)}impl.addToBeacon("c.lt.n",externalMetrics.longTasksCount(),!0);impl.addToBeacon("c.lt.tt",externalMetrics.longTasksTime());impl.addToBeacon("c.lt",compressJson(objs))}}function stop(){enabled=!1;perfObserver.disconnect();clearTasks()}function onBeacon(){clearTasks()}if(w.PerformanceObserver&&w.PerformanceLongTaskTiming){var ATTRIBUTION_TYPES={unknown:0,self:1,"same-origin-ancestor":2,"same-origin-descendant":3,"same-origin":4,"cross-origin-ancestor":5,"cross-origin-descendant":6,"cross-origin-unreachable":7,"multiple-contexts":8},CULPRIT_ATTRIBUTION_NAMES={unknown:0,script:1,layout:2},CULPRIT_TYPES={unknown:0,iframe:1,embed:2,object:3},perfObserver=new w.PerformanceObserver(onPerformanceObserver);try{perfObserver.observe({entryTypes:["longtask"]})}catch(e){return}t.register("longtask",COMPRESS_MODE_SMALL_NUMBERS);var longTasks=[],enabled=!0,longTasksTime=0;externalMetrics.longTasksTime=function(){return longTasksTime};externalMetrics.longTasksCount=function(){return longTasks.length};return{getTasks:getTasks,clearTasks:clearTasks,analyze:analyze,stop:stop,onBeacon:onBeacon}}},PageBusyMonitor=function(w,t){function onPoll(){var now=BOOMR.now(),delta=now-last;last=now;if(delta>2*POLLING_INTERVAL+ALLOWED_DEVIATION_MS){var missedPolls=Math.floor((delta-POLLING_INTERVAL)/POLLING_INTERVAL);total+=missedPolls;late+=missedPolls;delta-=missedPolls*POLLING_INTERVAL}total++;delta>POLLING_INTERVAL+ALLOWED_DEVIATION_MS&&late++}function onReport(){var reportTime=t.getTimeBucket(),curTime=reportTime,missedReports=0;if(0!==total){for(;total>POLLS_PER_REPORT+1&&missedReports<=MAX_MISSED_REPORTS;){t.set("busy",100,--curTime);total-=POLLS_PER_REPORT;late=Math.max(late-POLLS_PER_REPORT,0);overallTotal+=POLLS_PER_REPORT;overallLate+=POLLS_PER_REPORT;missedReports++}overallTotal+=total;overallLate+=late;t.set("busy",Math.round(late/total*100),reportTime);total=0;late=0}}function analyze(startTime){impl.addToBeacon("c.b",externalMetrics.pageBusy())}function stop(){enabled=!1;if(pollInterval){clearInterval(pollInterval);pollInterval=!1}if(reportInterval){clearInterval(reportInterval);reportInterval=!1}}function onBeacon(){overallTotal=0;overallLate=0}t.register("busy",COMPRESS_MODE_PERCENT);var POLLING_INTERVAL=32,ALLOWED_DEVIATION_MS=4,REPORT_INTERVAL=100,POLLS_PER_REPORT=Math.floor(REPORT_INTERVAL/POLLING_INTERVAL),MAX_MISSED_REPORTS=100,last=BOOMR.now(),total=0,late=0,overallTotal=0,overallLate=0,enabled=!0,pollInterval=!1,reportInterval=!1;externalMetrics.pageBusy=function(){return 0===overallTotal?0:Math.round(overallLate/overallTotal*100)};pollInterval=setInterval(onPoll,POLLING_INTERVAL);reportInterval=setInterval(onReport,REPORT_INTERVAL);return{analyze:analyze,stop:stop,onBeacon:onBeacon}},FrameRateMonitor=function(w,t){function frame(now){if(enabled){now-lastFrame>=LONG_FRAME_MAX&&longFrames++;lastFrame=now;totalFrames++;t.increment("fps");w.requestAnimationFrame(frame)}}function analyze(startTime){impl.addToBeacon("c.f",externalMetrics.fps());impl.addToBeacon("c.f.d",externalMetrics.fpsDuration());impl.addToBeacon("c.f.m",externalMetrics.fpsMinimum());impl.addToBeacon("c.f.l",externalMetrics.fpsLongFrames());impl.addToBeacon("c.f.s",externalMetrics.fpsStart())}function stop(){enabled=!1;frameStartTime=0}function onBeacon(){enabled&&(frameStartTime=BOOMR.now());totalFrames=0;longFrames=0}t.register("fps",COMPRESS_MODE_SMALL_NUMBERS);var frameStartTime,lastFrame,LONG_FRAME_MAX=50,totalFrames=0,longFrames=0,enabled=!0;if(BOOMR.fpsLog&&BOOMR.fpsLog.length){lastFrame=frameStartTime=BOOMR.fpsLog[0]+epoch;for(var i=0;i<BOOMR.fpsLog.length;i++){var ts=epoch+BOOMR.fpsLog[i];t.increment("fps",1,Math.floor((ts-frameStartTime)/COLLECTION_INTERVAL));ts-lastFrame>=LONG_FRAME_MAX&&longFrames++;lastFrame=ts}totalFrames=BOOMR.fpsLog.length;delete BOOMR.fpsLog}else frameStartTime=BOOMR.now();w.requestAnimationFrame(frame);externalMetrics.fps=function(){var dur=externalMetrics.fpsDuration();if(dur)return Math.floor(totalFrames/(dur/1e3))};externalMetrics.fpsDuration=function(){if(frameStartTime)return BOOMR.now()-frameStartTime};externalMetrics.fpsMinimum=function(){if(externalMetrics.fpsDuration()){var min=t.getStats("fps",frameStartTime).min;return min!==1/0?min:void 0}};externalMetrics.fpsLongFrames=function(){return longFrames};externalMetrics.fpsStart=function(){return frameStartTime?frameStartTime.toString(36):0};return{analyze:analyze,stop:stop,onBeacon:onBeacon}},ScrollMonitor=function(w,t,i){function onScroll(e){var now=BOOMR.now();scrollCount++;now-lastScroll>DISTINCT_SCROLL_SECONDS&&distinctScrollCount++;lastScroll=now;var curY=BOOMR.utils.scroll().y,diffY=Math.abs(lastY-curY);scrollPixels+=diffY;t.increment("scroll",diffY);if(0===lastYLogged||Math.abs(lastYLogged-curY)>MIN_SCROLL_Y_CHANGE_FOR_LOG){t.log(LOG_TYPE_SCROLL,now,{y:curY});lastYLogged=curY}i.interact("scroll",now,e);intervalScrollPct+=Math.round(diffY/documentHeight*100);totalScrollPct+=Math.round(diffY/documentHeight*100);lastY=curY}function reportScroll(){var pct=Math.min(intervalScrollPct,100);0!==pct&&t.set("scrollpct",pct);intervalScrollPct=0}function analyze(startTime){impl.addToBeacon("c.s",externalMetrics.scrollCount());impl.addToBeacon("c.s.p",externalMetrics.scrollPct());impl.addToBeacon("c.s.y",externalMetrics.scrollPixels());impl.addToBeacon("c.s.d",externalMetrics.scrollDistinct())}function stop(){if(collectionInterval){clearInterval(collectionInterval);collectionInterval=!1}BOOMR.utils.removeListener(w,"scroll",onScroll)}function onBeacon(){totalScrollPct=0;scrollCount=0;scrollPixels=0;distinctScrollCount=0}if(w&&w.document&&w.document.body&&w.document.documentElement){var DISTINCT_SCROLL_SECONDS=2e3,MIN_SCROLL_Y_CHANGE_FOR_LOG=20,lastY=0,lastYLogged=0,intervalScrollPct=0,totalScrollPct=0,scrollCount=0,scrollPixels=0,distinctScrollCount=0,lastScroll=0,collectionInterval=!1,body=w.document.body,html=w.document.documentElement;t.register("scroll",COMPRESS_MODE_SMALL_NUMBERS);t.register("scrollpct",COMPRESS_MODE_PERCENT);var documentHeight=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight)-BOOMR.utils.windowHeight();externalMetrics.scrollPct=function(){return totalScrollPct};externalMetrics.scrollCount=function(){return scrollCount};externalMetrics.scrollDistinct=function(){return distinctScrollCount};externalMetrics.scrollPixels=function(){return scrollPixels};BOOMR.utils.addListener(w,"scroll",onScroll,!0);collectionInterval=setInterval(reportScroll,COLLECTION_INTERVAL);return{analyze:analyze,stop:stop,onBeacon:onBeacon}}},ClickMonitor=function(w,t,i){function onClick(e){var now=BOOMR.now(),newX=e.clientX,newY=e.clientY;clickCount++;var pixels=Math.round(Math.sqrt(Math.pow(y-newY,2)+Math.pow(x-newX,2)));if(lastTarget===e.target||pixels<=PIXEL_AREA){sameClicks++;if(sameClicks+1>=RAGE_CLICK_THRESHOLD){rageClicks++;BOOMR.fireEvent("rage_click",e)}}else sameClicks=0;x=newX;y=newY;lastTarget=e.target;t.increment("click");t.log(LOG_TYPE_CLICK,now,{x:newX,y:newY});i.interact("click",now,e)}function analyze(startTime){impl.addToBeacon("c.c",externalMetrics.clicksCount());impl.addToBeacon("c.c.r",externalMetrics.clicksRage())}function stop(){BOOMR.utils.removeListener(w.document,"click",onClick)}function onBeacon(){clickCount=0;sameClicks=0;rageClicks=0}t.register("click",COMPRESS_MODE_SMALL_NUMBERS);var PIXEL_AREA=10,RAGE_CLICK_THRESHOLD=3,clickCount=0,sameClicks=0,rageClicks=0,x=0,y=0,lastTarget=null;externalMetrics.clicksCount=function(){return clickCount};externalMetrics.clicksRage=function(){return rageClicks};BOOMR.utils.addListener(w.document,"click",onClick,!0);return{analyze:analyze,stop:stop,onBeacon:onBeacon}},KeyMonitor=function(w,t,i){function onKeyDown(e){var now=BOOMR.now();keyCount++;27===e.keyCode&&escKeyCount++;t.increment("key");t.log(LOG_TYPE_KEY,now);i.interact("key",now,e)}function analyze(startTime){impl.addToBeacon("c.k",externalMetrics.keyCount());impl.addToBeacon("c.k.e",externalMetrics.keyEscapes())}function stop(){BOOMR.utils.removeListener(w.document,"keydown",onKeyDown)}function onBeacon(){keyCount=0;escKeyCount=0}t.register("key",COMPRESS_MODE_SMALL_NUMBERS);var keyCount=0,escKeyCount=0;externalMetrics.keyCount=function(){return keyCount};externalMetrics.keyEscapes=function(){return escKeyCount};BOOMR.utils.addListener(w.document,"keydown",onKeyDown,!0);return{analyze:analyze,stop:stop,onBeacon:onBeacon}},MouseMonitor=function(w,t,i){function onMouseMove(e){var newX=(BOOMR.now(),e.clientX),newY=e.clientY,pixels=Math.round(Math.sqrt(Math.pow(lastY-newY,2)+Math.pow(lastX-newX,2))),newPct=Math.round(pixels/screenPixels*100);intervalMousePct+=newPct;totalMousePct+=newPct;totalMousePixels+=pixels;lastX=newX;lastY=newY;t.increment("mouse",pixels)}function reportMousePct(){var pct=Math.min(intervalMousePct,100);0!==pct&&t.set("mousepct",pct);intervalMousePct=0}function reportMouseLog(){if(lastLogX!==lastX||lastLogY!==lastY){if(Math.round(Math.sqrt(Math.pow(lastLogY-lastY,2)+Math.pow(lastLogX-lastX,2)))>=MIN_LOG_PIXEL_CHANGE){t.log(LOG_TYPE_MOUSE,BOOMR.now(),{x:lastX,y:lastY});lastLogX=lastX;lastLogY=lastY}}}function analyze(startTime){impl.addToBeacon("c.m.p",externalMetrics.mousePct());impl.addToBeacon("c.m.n",externalMetrics.mousePixels())}function stop(){if(reportMousePctInterval){clearInterval(reportMousePctInterval);reportMousePctInterval=!1}if(reportMouseLogInterval){clearInterval(reportMouseLogInterval);reportMouseLogInterval=!1}BOOMR.utils.removeListener(w.document,"mousemove",onMouseMove)}function onBeacon(){totalMousePct=0;totalMousePixels=0}t.register("mouse",COMPRESS_MODE_SMALL_NUMBERS);t.register("mousepct",COMPRESS_MODE_PERCENT);var MIN_LOG_PIXEL_CHANGE=10,REPORT_LOG_INTERVAL=250,lastX=0,lastY=0,lastLogX=0,lastLogY=0,intervalMousePct=0,totalMousePct=0,totalMousePixels=0,reportMousePctInterval=!1,reportMouseLogInterval=!1,screenPixels=Math.round(Math.sqrt(Math.pow(BOOMR.utils.windowHeight(),2)+Math.pow(BOOMR.utils.windowWidth(),2)));externalMetrics.mousePct=function(){return totalMousePct};externalMetrics.mousePixels=function(){return totalMousePixels};reportMousePctInterval=setInterval(reportMousePct,COLLECTION_INTERVAL);reportMouseLogInterval=setInterval(reportMouseLog,REPORT_LOG_INTERVAL);BOOMR.utils.addListener(w.document,"mousemove",onMouseMove,!0);return{analyze:analyze,stop:stop,onBeacon:onBeacon}},InteractionMonitor=function(w,t,afterOnloadMinWait){function interact(type,now,e){now=now||BOOMR.now();if(enabled){interactions++;timeToFirstInteraction||(timeToFirstInteraction=now);var delay=0;if(e&&e.timeStamp){delay=e.timeStamp>14e11?now-e.timeStamp:now-epoch-e.timeStamp;interactionsDelay+=delay;null===firstInputDelay&&(firstInputDelay=Math.round(delay));if(delay>INTERACTION_MAX_DELAY){t.increment("interdly");delayedInteractions++;delayedInteractionTime+=delay}}t.increment("inter");if(!isSpaNav&&impl.afterOnloadMonitoring){beaconEndTime=BOOMR.now();if(!beaconStartTime){debug("Interaction detected, sending a beacon after "+INTERACTION_MIN_WAIT_FOR_BEACON+" ms");beaconStartTime=beaconEndTime;beaconMaxTimeout=setTimeout(sendInteractionBeacon,INTERACTION_MAX_WAIT_FOR_BEACON)}if(beaconMinTimeout){debug("Clearing previous interaction timeout");clearTimeout(beaconMinTimeout);beaconMinTimeout=!1}beaconMinTimeout=setTimeout(sendInteractionBeacon,INTERACTION_MIN_WAIT_FOR_BEACON)}}}function onSpaInit(){isSpaNav=!0;clearBeaconTimers()}function clearBeaconTimers(){if(beaconMinTimeout){clearTimeout(beaconMinTimeout);beaconMinTimeout=!1}if(beaconMaxTimeout){clearTimeout(beaconMaxTimeout);beaconMaxTimeout=!1}}function sendInteractionBeacon(){debug("Sending interaction beacon");clearBeaconTimers();BOOMR.fireEvent("interaction");impl.addToBeacon("rt.tstart",beaconStartTime);impl.addToBeacon("rt.end",beaconEndTime);impl.addToBeacon("rt.start","manual");impl.addToBeacon("http.initiator","interaction");BOOMR.sendBeacon()}function analyze(startTime){impl.addToBeacon("c.ttfi",externalMetrics.timeToFirstInteraction());impl.addToBeacon("c.i.dc",externalMetrics.interactionDelayed());impl.addToBeacon("c.i.dt",externalMetrics.interactionDelayedTime());impl.addToBeacon("c.i.a",externalMetrics.interactionAvgDelay());null!==firstInputDelay&&impl.addToBeacon("c.fid",externalMetrics.firstInputDelay(),!0)}function stop(){enabled=!1}function onBeacon(){delayedInteractionTime=0;delayedInteractions=0;interactions=0;interactionsDelay=0;beaconStartTime=0;beaconEndTime=0;isSpaNav=!1;clearBeaconTimers()}t.register("inter",COMPRESS_MODE_SMALL_NUMBERS);t.register("interdly",COMPRESS_MODE_SMALL_NUMBERS);var INTERACTION_MAX_DELAY=50,INTERACTION_MIN_WAIT_FOR_BEACON=afterOnloadMinWait,INTERACTION_MAX_WAIT_FOR_BEACON=3e4,timeToFirstInteraction=0,firstInputDelay=null,interactions=0,interactionsDelay=0,delayedInteractions=0,delayedInteractionTime=0,enabled=!0,beaconStartTime=0,beaconEndTime=0,beaconMinTimeout=!1,beaconMaxTimeout=!1,isSpaNav=!1;externalMetrics.interactionDelayed=function(){return delayedInteractions};externalMetrics.interactionDelayedTime=function(){return Math.round(delayedInteractionTime)};externalMetrics.interactionAvgDelay=function(){if(interactions>0)return Math.round(interactionsDelay/interactions)};externalMetrics.timeToFirstInteraction=function(){if(timeToFirstInteraction)return timeToFirstInteraction-epoch};externalMetrics.firstInputDelay=function(){if(null!==firstInputDelay)return firstInputDelay};BOOMR.subscribe("spa_init",onSpaInit,null,impl);return{interact:interact,analyze:analyze,stop:stop,onBeacon:onBeacon}},VisibilityMonitor=function(w,t,i){function stop(){enabled=!1}t.register("vis",COMPRESS_MODE_SMALL_NUMBERS);var VIS_MAP={visible:0,hidden:1,prerender:2,unloaded:3},enabled=!0;BOOMR.subscribe("visibility_changed",function(e){var now=BOOMR.now();if(enabled){t.increment("vis");t.log(LOG_TYPE_VIS,now,{s:VIS_MAP[BOOMR.visibilityState()]});i.interact("vis",now,e)}});return{stop:stop}},OrientationMonitor=function(w,t,i){function onOrientationChange(e){var now=BOOMR.now();if(enabled){t.increment("orn");t.log(LOG_TYPE_ORIENTATION,now,{a:screen.orientation.angle});i.interact("orn",now,e)}}function stop(){enabled=!1;BOOMR.utils.removeListener(w,"orientationchange",onOrientationChange)}t.register("orn",COMPRESS_MODE_SMALL_NUMBERS);var enabled=!0;BOOMR.utils.addListener(w,"orientationchange",onOrientationChange,!0);return{stop:stop}},StatsMonitor=function(w,t){function reportStats(){var mem=p&&p.memory&&p.memory.usedJSHeapSize;mem&&t.set("mem",mem);domLength=domAllNodes.length;t.set("domsz",d.documentElement.innerHTML.length);t.set("domln",domLength);if(mutationCount>0){var deltaPct=Math.min(Math.round(mutationCount/domLength*100),100);t.set("mut",deltaPct);mutationCount=0}}function onBatteryLevelChange(){enabled&&battery&&t.set("bat",battery.level)}function onMutationObserver(mutations){mutations.forEach(function(mutation){if("childList"===mutation.type)for(var i=0;i<mutation.addedNodes.length;i++){var node=mutation.addedNodes[i];mutationCount++;mutationCount+=node.getElementsByTagName?node.getElementsByTagName("*").length:0}})}function stop(){enabled=!1;if(reportInterval){clearInterval(reportInterval);reportInterval=!1}observer&&observer.disconnect();battery&&battery.onlevelchange&&(battery.onlevelchange=null);domAllNodes=null}t.register("mem",COMPRESS_MODE_LARGE_NUMBERS,!0);t.register("bat",COMPRESS_MODE_PERCENT,!0);t.register("domsz",COMPRESS_MODE_LARGE_NUMBERS,!0);t.register("domln",COMPRESS_MODE_LARGE_NUMBERS,!0);t.register("mut",COMPRESS_MODE_SMALL_NUMBERS);var observer,REPORT_INTERVAL=1e3,d=w.document,enabled=!0,reportInterval=!1,battery=null,mutationCount=0,domLength=0,domAllNodes=d.getElementsByTagName("*");reportInterval=setInterval(reportStats,REPORT_INTERVAL);w.navigator&&"function"==typeof w.navigator.getBattery&&w.navigator.getBattery().then(function(b){battery=b;battery.onlevelchange&&(battery.onlevelchange=onBatteryLevelChange)});if("function"==typeof w.MutationObserver){observer=new w.MutationObserver(onMutationObserver);observer.observe(d,{childList:!0,subtree:!0})}return{stop:stop}};impl={monitorLongTasks:!0,monitorPageBusy:!0,monitorFrameRate:!0,monitorInteractions:!0,monitorStats:!0,afterOnload:!1,afterOnloadMaxLength:6e4,afterOnloadMinWait:5e3,waitAfterOnload:!1,ttiWaitForFrameworkReady:!1,ttiWaitForHeroImages:!1,sendLog:!0,sendTimeline:!0,logMaxEntries:100,initialized:!1,complete:!1,isSpa:!1,firedPageReady:!1,afterOnloadMonitoring:!1,frameworkReady:null,timeline:null,ttiMethod:null,longTaskMonitor:null,pageBusyMonitor:null,frameRateMonitor:null,interactionMonitor:null,scrollMonitor:null,clickMonitor:null,keyMonitor:null,mouseMonitor:null,visibilityMonitor:null,orientationMonitor:null,statsMonitor:null,addedVars:[],monitors:["timeline","longTaskMonitor","pageBusyMonitor","frameRateMonitor","scrollMonitor","keyMonitor","clickMonitor","mouseMonitor","interactionMonitor","visibilityMonitor","orientationMonitor","statsMonitor"],timeOfLastBeacon:0,hasAddedDataToBeacon:!1,onBeforeBeacon:function(){impl.runAllAnalyzers()},runAllAnalyzers:function(){var i,mon;if(!impl.hasAddedDataToBeacon){for(i=0;i<impl.monitors.length;i++){mon=impl[impl.monitors[i]];mon&&"function"==typeof mon.analyze&&mon.analyze(impl.timeOfLastBeacon)}impl.addToBeacon("c.lb",impl.timeOfLastBeacon?impl.timeOfLastBeacon.toString(36):0);impl.timeOfLastBeacon=BOOMR.now();impl.hasAddedDataToBeacon=!0}},onBeacon:function(){var i;if(impl.addedVars&&impl.addedVars.length>0){BOOMR.removeVar(impl.addedVars);impl.addedVars=[]}for(i=0;i<impl.monitors.length;i++){var monitor=impl[impl.monitors[i]];if(monitor){impl.afterOnload||"function"==typeof monitor.stop&&monitor.stop();"function"==typeof monitor.onBeacon&&monitor.onBeacon()}}impl.hasAddedDataToBeacon=!1},onXhrLoad:function(data){data&&BOOMR.utils.inArray(data.initiator,BOOMR.constants.BEACON_TYPE_SPAS)&&(impl.isSpa=!0);data&&"spa_hard"===data.initiator&&impl.onPageReady()},onPageReady:function(){impl.firedPageReady=!0;if(impl.afterOnload&&impl.monitorInteractions){impl.afterOnloadMonitoring=!0;impl.isSpa||"number"!=typeof impl.afterOnloadMaxLength||setTimeout(function(){impl.afterOnloadMonitoring=!1},impl.afterOnloadMaxLength)}if(impl.waitAfterOnload){var start=BOOMR.now();setTimeout(function checkTti(){if(BOOMR.now()-start>impl.waitAfterOnload){impl.complete=!0;BOOMR.sendBeacon()}else{impl.timeline.analyze();if(externalMetrics.timeToInteractive()){impl.complete=!0;BOOMR.sendBeacon()}else setTimeout(checkTti,TIME_TO_INTERACTIVE_WAIT_POLL_PERIOD)}},TIME_TO_INTERACTIVE_WAIT_POLL_PERIOD)}else impl.complete=!0},addToBeacon:function(name,val,force){if(0!==val&&void 0!==val||force){BOOMR.addVar(name,val);impl.addedVars.push(name)}else BOOMR.removeVar(name)}};BOOMR.plugins.Continuity={init:function(config){BOOMR.utils.pluginConfig(impl,config,"Continuity",["monitorLongTasks","monitorPageBusy","monitorFrameRate","monitorInteractions","monitorStats","afterOnload","afterOnloadMaxLength","afterOnloadMinWait","waitAfterOnload","ttiWaitForFrameworkReady","ttiWaitForHeroImages","sendLog","logMaxEntries","sendTimeline"]);if(impl.initialized)return this;impl.initialized=!0;impl.timeline=new Timeline(BOOMR.now());if(BOOMR.window){if(impl.monitorLongTasks&&BOOMR.window.PerformanceObserver&&BOOMR.window.PerformanceLongTaskTiming){impl.longTaskMonitor=new LongTaskMonitor(BOOMR.window,impl.timeline);impl.ttiMethod="lt"}if(impl.monitorFrameRate&&"function"==typeof BOOMR.window.requestAnimationFrame){impl.frameRateMonitor=new FrameRateMonitor(BOOMR.window,impl.timeline);impl.ttiMethod||(impl.ttiMethod="raf")}if(impl.monitorPageBusy&&(!BOOMR.window.PerformanceObserver||!BOOMR.window.PerformanceLongTaskTiming||!impl.monitorLongTasks)){impl.pageBusyMonitor=new PageBusyMonitor(BOOMR.window,impl.timeline);impl.ttiMethod||(impl.ttiMethod="b")}if(impl.monitorInteractions){impl.interactionMonitor=new InteractionMonitor(BOOMR.window,impl.timeline,impl.afterOnloadMinWait);impl.scrollMonitor=new ScrollMonitor(BOOMR.window,impl.timeline,impl.interactionMonitor);impl.keyMonitor=new KeyMonitor(BOOMR.window,impl.timeline,impl.interactionMonitor);impl.clickMonitor=new ClickMonitor(BOOMR.window,impl.timeline,impl.interactionMonitor);impl.mouseMonitor=new MouseMonitor(BOOMR.window,impl.timeline,impl.interactionMonitor);impl.visibilityMonitor=new VisibilityMonitor(BOOMR.window,impl.timeline,impl.interactionMonitor);impl.orientationMonitor=new OrientationMonitor(BOOMR.window,impl.timeline,impl.interactionMonitor)}impl.monitorStats&&(impl.statsMonitor=new StatsMonitor(BOOMR.window,impl.timeline,impl.interactionMonitor))}BOOMR.addVar("c.e",epoch.toString(36));BOOMR.addVar("c.tti.m",impl.ttiMethod);BOOMR.subscribe("before_beacon",impl.onBeforeBeacon,null,impl);BOOMR.subscribe("beacon",impl.onBeacon,null,impl);BOOMR.subscribe("page_ready",impl.onPageReady,null,impl);BOOMR.subscribe("xhr_load",impl.onXhrLoad,null,impl);return this},is_complete:function(vars){return impl.complete||vars&&"error"===vars["http.initiator"]},frameworkReady:function(){impl.frameworkReady=BOOMR.now()},metrics:externalMetrics}}}();!function(){function log(msg){BOOMR.debug(msg,"AutoXHR")}function getPathName(anchor){if(!anchor)return null;anchor.href=anchor.href;var pathName=anchor.pathname;"/"!==pathName.charAt(0)&&(pathName="/"+pathName);return pathName}function shouldExcludeXhr(anchor){if(anchor.href){if(anchor.href.match(/^(about:|javascript:|data:)/i))return!0;if(0===anchor.href.indexOf(BOOMR.getBeaconURL()))return!0}return BOOMR.xhr_excludes.hasOwnProperty(anchor.href)||BOOMR.xhr_excludes.hasOwnProperty(anchor.hostname)||BOOMR.xhr_excludes.hasOwnProperty(getPathName(anchor))}function shouldExcludeXhrBody(url){if(!BOOMR.xhr_body_excludes)return!1;for(var i=0;i<BOOMR.xhr_body_excludes.length;i++)if(-1!==url.indexOf(BOOMR.xhr_body_excludes[i]))return!0;return!1}function MutationHandler(){this.watch=0;this.timer=null;this.pending_events=[];this.lastSpaLocation=null}function instrumentClick(){BOOMR.subscribe("click",function(){if(!singlePageApp){var resource={timing:{},initiator:"click"};if(BOOMR.orig_XMLHttpRequest&&BOOMR.orig_XMLHttpRequest!==BOOMR.window.XMLHttpRequest){resource.timing.requestStart=BOOMR.now();handler.addEvent(resource)}}})}function instrumentXHR(){
if(!BOOMR.proxy_XMLHttpRequest||BOOMR.proxy_XMLHttpRequest!==BOOMR.window.XMLHttpRequest)if(BOOMR.proxy_XMLHttpRequest&&BOOMR.orig_XMLHttpRequest&&BOOMR.orig_XMLHttpRequest===BOOMR.window.XMLHttpRequest){BOOMR.window.XMLHttpRequest=BOOMR.proxy_XMLHttpRequest;MutationHandler.start()}else{BOOMR.orig_XMLHttpRequest=BOOMR.window.orig_XMLHttpRequest||BOOMR.window.XMLHttpRequest;MutationHandler.start();instrumentClick();BOOMR.proxy_XMLHttpRequest=function(){var req,orig_open,orig_send,resource={timing:{},initiator:"xhr"},opened=!1,excluded=!1;req=new BOOMR.orig_XMLHttpRequest;orig_open=req.open;orig_send=req.send;req.open=function(method,url,async){function loadFinished(){var entry,navSt,entryStartTime,entryResponseEnd,useRT=!1,now=BOOMR.now();if(!resource.timing.loadEventEnd){if(resource.status){var errorGuid=req.getResponseHeader(ERROR_GUID_ID);resource.responseErrorGuid=errorGuid?ERROR_GUID_ID+":"+errorGuid:null;BOOMR.fireEvent("xhr_error",resource)}resource.timing.loadEventEnd=now;entry=BOOMR.getResourceTiming(resource.url,function(x,y){return x.responseEnd-y.responseEnd});if(entry){navSt=BOOMR.getPerformance().timing.navigationStart;resource.timing.loadEventEnd=BOOMR.now();entryStartTime=Math.floor(navSt+entry.startTime);if(resource.timing.requestStart-entryStartTime>=2)useRT=!1;else{if(0!==entry.responseEnd){entryResponseEnd=Math.floor(navSt+entry.responseEnd);if(entryResponseEnd<=resource.timing.loadEventEnd){resource.timing.responseEnd=entryResponseEnd;useRT=!0;resource.restiming=entry}}if(useRT){resource.timing.requestStart=entryStartTime;resource.timing.fetchStart=entryStartTime;0!==entry.responseStart&&(resource.timing.responseStart=Math.floor(navSt+entry.responseStart))}}}resource.index>-1?handler.load_finished(resource.index,resource.timing.responseEnd):impl.alwaysSendXhr?handler.sendResource(resource):singlePageApp&&!autoXhrEnabled||handler.addEvent(resource)}}function addListener(ename,stat){req.addEventListener(ename,function(){if("readystatechange"===ename){resource.timing[readyStateMap[req.readyState]]=BOOMR.now();if(4===req.readyState&&0!==req.status){(req.status<200||req.status>=400)&&(resource.status=req.status);resource.response={text:""===req.responseType||"text"===req.responseType?req.responseText:null,xml:""===req.responseType||"document"===req.responseType?req.responseXML:null,raw:req.response,json:req.responseJSON};loadFinished()}}else{resource.status=void 0===stat?req.status:stat;loadFinished()}},!1)}a.href=url;if(impl.excludeFilter(a)){excluded=!0;BOOMR.debug("Exclude found for resource: "+a.href+" Skipping instrumentation!","AutoXHR");return orig_open.apply(req,arguments)}excluded=!1;void 0===async&&(async=!0);BOOMR.fireEvent("xhr_init","xhr");if(!opened){async&&addListener("readystatechange");addListener("load");addListener("timeout",XHR_STATUS_TIMEOUT);addListener("error",XHR_STATUS_ERROR);addListener("abort",XHR_STATUS_ABORT)}resource.url=a.href;resource.method=method;delete resource.status;async||(resource.synchronous=!0);opened=!0;try{return orig_open.apply(req,arguments)}catch(e){resource.status=XHR_STATUS_OPEN_EXCEPTION;loadFinished();throw e}};req.send=function(data){if(excluded)return orig_send.apply(req,arguments);req.resource.requestPayload=data;BOOMR.fireEvent("xhr_send",req);resource.timing.requestStart=BOOMR.now();data&&resource.url&&!shouldExcludeXhrBody(resource.url)&&(resource.body=data);singlePageApp&&handler.watch&&!impl.alwaysSendXhr&&handler.add_event_resource(resource);return void 0===resource.status||resource.status!==XHR_STATUS_OPEN_EXCEPTION?orig_send.apply(req,arguments):void 0};req.resource=resource;return req};BOOMR.proxy_XMLHttpRequest.UNSENT=0;BOOMR.proxy_XMLHttpRequest.OPENED=1;BOOMR.proxy_XMLHttpRequest.HEADERS_RECEIVED=2;BOOMR.proxy_XMLHttpRequest.LOADING=3;BOOMR.proxy_XMLHttpRequest.DONE=4;BOOMR.proxy_XMLHttpRequest.prototype=BOOMR.orig_XMLHttpRequest.prototype;BOOMR.window.XMLHttpRequest=BOOMR.proxy_XMLHttpRequest}}function uninstrumentXHR(){BOOMR.orig_XMLHttpRequest&&BOOMR.orig_XMLHttpRequest!==BOOMR.window.XMLHttpRequest&&(BOOMR.window.XMLHttpRequest=BOOMR.orig_XMLHttpRequest)}function sendResource(resource){resource.initiator="xhr";BOOMR.responseEnd(resource)}var w,d,handler,a,impl,singlePageApp=!1,autoXhrEnabled=!1,readyStateMap=["uninitialized","open","responseStart","domInteractive","responseEnd"],SPA_TIMEOUT=1e3,XHR_STATUS_TIMEOUT=-1001,XHR_STATUS_ABORT=-999,XHR_STATUS_ERROR=-998,XHR_STATUS_OPEN_EXCEPTION=-997,SPA_RESOURCES_BACK_END=["xmlhttprequest","script"],ERROR_GUID_ID="TraceId";if(!BOOMR.plugins.AutoXHR){w=BOOMR.window;if(w&&w.XMLHttpRequest&&(new w.XMLHttpRequest).addEventListener){MutationHandler.stop=function(){MutationHandler.pause();MutationHandler.observer=null};MutationHandler.pause=function(){if(MutationHandler.observer&&MutationHandler.observer.observer&&!MutationHandler.isPaused){MutationHandler.isPaused=!0;MutationHandler.observer.observer.disconnect()}};MutationHandler.resume=function(){if(MutationHandler.observer&&MutationHandler.observer.observer&&MutationHandler.isPaused){MutationHandler.isPaused=!1;MutationHandler.observer.observer.observe(d,MutationHandler.observer.config)}};MutationHandler.start=function(){if(!MutationHandler.observer){var config={childList:!0,attributes:!0,subtree:!0,attributeFilter:["src","href"]};MutationHandler.observer=BOOMR.utils.addObserver(d,config,null,handler.mutation_cb,null,handler);if(MutationHandler.observer){MutationHandler.observer.config=config;BOOMR.subscribe("page_unload",MutationHandler.stop,null,MutationHandler)}}};MutationHandler.prototype.addEvent=function(resource){var i,last_ev,last_ev_index,ev={type:resource.initiator,resource:resource,nodes_to_wait:0,total_nodes:0,resources:[],complete:!1},index=this.pending_events.length;for(i=index-1;i>=0;i--)if(this.pending_events[i]&&!this.pending_events[i].complete){last_ev=this.pending_events[i];last_ev_index=i;break}if(last_ev)if("click"===last_ev.type)0!==last_ev.nodes_to_wait&&last_ev.resource.url||(this.pending_events[i]=void 0);else if("xhr"===last_ev.type){if("click"===ev.type)return null}else if(BOOMR.utils.inArray(last_ev.type,BOOMR.constants.BEACON_TYPE_SPAS)){if("xhr"===ev.type)return null;if(BOOMR.utils.inArray(ev.type,BOOMR.constants.BEACON_TYPE_SPAS)){BOOMR.debug("Aborting previous SPA navigation");last_ev.resource.timing.loadEventEnd=BOOMR.now();last_ev.aborted=!0;this.sendEvent(last_ev_index)}}this.watch++;this.pending_events.push(ev);if(MutationHandler.observer){BOOMR.utils.inArray(ev.type,BOOMR.constants.BEACON_TYPE_SPAS)?this.setTimeout(SPA_TIMEOUT,index):this.setTimeout(50,index);return index}if(BOOMR.utils.inArray(ev.type,BOOMR.constants.BEACON_TYPE_SPAS)){MutationHandler.start();this.setTimeout(SPA_TIMEOUT,index);return index}resource.url&&resource.timing.loadEventEnd&&this.sendEvent(index);return null};MutationHandler.prototype.sendEvent=function(i){var ev=this.pending_events[i],self=this,now=BOOMR.now();if(ev&&!ev.complete){this.clearTimeout();if(BOOMR.readyToSend()){ev.complete=!0;this.watch--;ev.resource.resources=ev.resources;BOOMR.utils.inArray(ev.type,BOOMR.constants.BEACON_TYPE_SPAS)&&(ev.resource.url=d.URL);if("spa"===ev.type&&0===ev.total_nodes&&ev.resource.url===self.lastSpaLocation){log("SPA beacon cancelled, no URL change or resources triggered");this.pending_events[i]=void 0;return}if(BOOMR.utils.inArray(ev.type,BOOMR.constants.BEACON_TYPE_SPAS)){self.lastSpaLocation=ev.resource.url;ev.forced||0!==ev.total_nodes||(ev.resource.timing.loadEventEnd=now-SPA_TIMEOUT)}this.sendResource(ev.resource,i)}else setTimeout(function(){self.sendEvent(i)},500)}};MutationHandler.prototype.sendResource=function(resource,eventIndex){var self=this,ev=self.pending_events[eventIndex],startTime=resource.timing?resource.timing.requestStart:void 0,sendResponseEnd=function(markEnd,endTimestamp){markEnd&&(resource.timing.loadEventEnd=endTimestamp||BOOMR.now());BOOMR.real_sendBeacon();resource.onComplete&&resource.onComplete(resource);if(BOOMR.plugins.ResourceTiming&&BOOMR.plugins.ResourceTiming.is_enabled()&&resource.timing&&resource.timing.requestStart){var r=BOOMR.plugins.ResourceTiming.getCompressedResourceTiming(resource.timing.requestStart,resource.timing.loadEventEnd);BOOMR.plugins.ResourceTiming.addToBeacon(r)}if(BOOMR.utils.inArray(resource.initiator,BOOMR.constants.BEACON_TYPE_SPAS)){self.calculateSpaTimings(resource);if("number"==typeof eventIndex&&self.pending_events[eventIndex].aborted){BOOMR.addVar("pgu",d.URL);BOOMR.addVar("rt.quit","");BOOMR.addVar("rt.abld","");impl.addedVars.push("pgu","rt.quit","rt.abld")}}BOOMR.responseEnd(resource,startTime,resource);"number"==typeof eventIndex&&(self.pending_events[eventIndex]=void 0)};if(resource.wait)resource.waitComplete=function(){sendResponseEnd(!0)};else{if("spa_hard"===resource.initiator&&(!ev||!ev.aborted)&&d&&d.readyState&&"complete"!==d.readyState){BOOMR.window.addEventListener("load",function(){var loadTimestamp=BOOMR.now();BOOMR.setImmediate(function(){sendResponseEnd(!0,loadTimestamp)})});return}sendResponseEnd(!1)}};MutationHandler.prototype.calculateSpaTimings=function(resource){var p=BOOMR.getPerformance();if(p&&p.timing)if("spa_hard"===resource.initiator){resource.timing.responseEnd=p.timing.responseStart;resource.timing.fetchStart=p.timing.navigationStart}else{if(!BOOMR.plugins.ResourceTiming||!BOOMR.plugins.ResourceTiming.is_supported())return;var resources=BOOMR.plugins.ResourceTiming.getFilteredResourceTiming(resource.timing.requestStart,resource.timing.loadEventEnd,impl.spaBackEndResources).entries,totalTime=Math.round(resource.timing.loadEventEnd-resource.timing.requestStart);if(!resources||!resources.length){resource.timers={t_resp:0,t_page:totalTime,t_done:totalTime};return}for(var maxResponseEnd=resource.timing.loadEventEnd-p.timing.navigationStart,i=0;i<resources.length;i++)if(resources[i].responseStart>maxResponseEnd){resources[i].responseStart=maxResponseEnd;resources[i].responseEnd=maxResponseEnd}else resources[i].responseEnd>maxResponseEnd&&(resources[i].responseEnd=maxResponseEnd);var backEndTime=Math.round(BOOMR.plugins.ResourceTiming.calculateResourceTimingUnion(resources)),frontEndTime=totalTime-backEndTime;if(backEndTime<0||totalTime<0||frontEndTime<0){BOOMR.addError("Incorrect SPA time calculation");return}resource.timers={t_resp:backEndTime,t_page:frontEndTime,t_done:totalTime}}};MutationHandler.prototype.setTimeout=function(timeout,index){var self=this;if(timeout){this.clearTimeout();this.timer=setTimeout(function(){self.timedout(index)},timeout)}};MutationHandler.prototype.timedout=function(index){var ev;this.clearTimeout();ev=this.pending_events[index];if(ev&&BOOMR.utils.inArray(ev.type,BOOMR.constants.BEACON_TYPE_SPAS.concat("xhr")))0===ev.nodes_to_wait&&this.sendEvent(index);else{this.watch>0&&this.watch--;this.pending_events[index]=void 0}};MutationHandler.prototype.clearTimeout=function(){if(this.timer){clearTimeout(this.timer);this.timer=null}};MutationHandler.prototype.load_cb=function(ev,resourceNum){var target,index,now=BOOMR.now();target=ev.target||ev.srcElement;if(target&&target._bmr){index=target._bmr.idx;resourceNum=void 0!==resourceNum?resourceNum:target._bmr.res||0;if(!target._bmr.end[resourceNum]){target._bmr.end[resourceNum]=now;this.load_finished(index,now)}}};MutationHandler.prototype.load_finished=function(index,loadEventEnd){var current_event=this.pending_events[index];if(current_event){current_event.nodes_to_wait--;if(0===current_event.nodes_to_wait){current_event.resource.timing.loadEventEnd=loadEventEnd||BOOMR.now();BOOMR.utils.inArray(current_event.type,BOOMR.constants.BEACON_TYPE_SPAS)?this.setTimeout(SPA_TIMEOUT,index):this.sendEvent(index)}}};MutationHandler.prototype.wait_for_node=function(node,index){var current_event,els,i,l,url,resourceNum,self=this,interesting=!1,exisitingNodeSrcUrlChanged=!1;if(node.nodeName.toUpperCase().match(/^(IMG|SCRIPT|IFRAME|IMAGE)$/)||"LINK"===node.nodeName&&node.rel&&node.rel.match(/\<stylesheet\>/i)){node._bmr&&"number"==typeof node._bmr.res&&node._bmr.end[node._bmr.res]&&(exisitingNodeSrcUrlChanged=!0);url=node.src||node.getAttribute("xlink:href")||node.href;if("IMG"===node.nodeName){if(node.naturalWidth&&!exisitingNodeSrcUrlChanged)return!1;if(""===node.getAttribute("src"))return!1}if(!url||url.match(/^(about:|javascript:|data:)/i))return!1;current_event=this.pending_events[index];if(!current_event)return!1;resourceNum=current_event.resources.length;node._bmr||(node._bmr={end:{}});current_event.urls||(current_event.urls={});if(current_event.urls[url])return!1;if("SCRIPT"===node.nodeName&&singlePageApp)return!1;if(!current_event.resource.url){a.href=url;if(impl.excludeFilter(a)){BOOMR.debug("Exclude for "+a.href+" matched. Excluding","AutoXHR");return!1}current_event.resource.url=a.href}node._bmr.res=resourceNum;node._bmr.idx=index;delete node._bmr.end[resourceNum];node.addEventListener("load",function(ev){self.load_cb(ev,resourceNum)});node.addEventListener("error",function(ev){self.load_cb(ev,resourceNum)});current_event.nodes_to_wait++;this.clearTimeout();current_event.total_nodes++;current_event.resources.push(node);current_event.urls[url]=1;interesting=!0}else node.nodeType===Node.ELEMENT_NODE&&["IMAGE","IMG"].forEach(function(tagName){els=node.getElementsByTagName(tagName);if(els&&els.length)for(i=0,l=els.length;i<l;i++)interesting|=this.wait_for_node(els[i],index)},this);return interesting};MutationHandler.prototype.add_event_resource=function(resource){var current_event,index=this.pending_events.length-1;if(index<0)return-1;current_event=this.pending_events[index];if(!current_event)return-1;if(!resource)return-1;current_event.nodes_to_wait++;current_event.total_nodes++;resource.index=index;return index};MutationHandler.prototype.mutation_cb=function(mutations){var self,index,evt;if(!this.watch)return!0;self=this;index=this.pending_events.length-1;if(index<0||!this.pending_events[index])return!0;evt=this.pending_events[index];void 0===evt.interesting&&(evt.interesting=!1);if(mutations&&mutations.length){evt.resource.timing.domComplete=BOOMR.now();mutations.forEach(function(mutation){var i,l,node;if("attributes"===mutation.type)evt.interesting|=self.wait_for_node(mutation.target,index);else if("childList"===mutation.type){l=mutation.addedNodes.length;for(i=0;i<l;i++)evt.interesting|=self.wait_for_node(mutation.addedNodes[i],index);l=mutation.removedNodes.length;for(i=0;i<l;i++){node=mutation.removedNodes[i];"IFRAME"===node.nodeName&&node._bmr&&self.load_cb({target:node,type:"removed"})}}})}if(!evt.interesting&&!this.timeoutExtended){this.setTimeout(1e3,index);this.timeoutExtended=!0}return!0};MutationHandler.prototype.queue_is_empty=function(){return 0===this.nodesWaitingFor()};MutationHandler.prototype.nodesWaitingFor=function(){if(0===this.pending_events.length)return 0;var index=this.pending_events.length-1;return this.pending_events[index]?this.pending_events[index].nodes_to_wait:0};MutationHandler.prototype.completeEvent=function(){var index,ev,now=BOOMR.now();if(0!==this.pending_events.length){index=this.pending_events.length-1;ev=this.pending_events[index];if(ev){ev.resource.timing.loadEventEnd=now;ev.forced=!0;this.sendEvent(index)}}};handler=new MutationHandler;impl={spaBackEndResources:SPA_RESOURCES_BACK_END,alwaysSendXhr:!1,excludeFilters:[],initialized:!1,addedVars:[],excludeFilter:function(anchor){var idx,ret,ctx;if(!anchor||!anchor.href)return!1;for(idx=0;idx<impl.excludeFilters.length;idx++)if("function"==typeof impl.excludeFilters[idx].cb){ctx=impl.excludeFilters[idx].ctx;impl.excludeFilters[idx].name&&log("Running filter: "+impl.excludeFilters[idx].name+" on URL: "+anchor.href);try{ret=impl.excludeFilters[idx].cb.call(ctx,anchor);if(ret){BOOMR.debug("Found matching filter at: "+impl.excludeFilters[idx].name+" for URL: "+anchor.href,"AutoXHR");return!0}}catch(exception){BOOMR.addError(exception,"BOOMR.plugins.AutoXHR.impl.excludeFilter()")}}return!1},clear:function(){if(impl.addedVars&&impl.addedVars.length>0){BOOMR.removeVar(impl.addedVars);impl.addedVars=[]}}};BOOMR.plugins.AutoXHR={is_complete:function(){return!0},init:function(config){function sendXhrs(resources){if(resources.length)for(i=0;i<resources.length;i++)sendResource(resources[i]);else sendResource(resources)}var i,idx;if(BOOMR.window&&BOOMR.window.document){d=BOOMR.window.document;a=BOOMR.window.document.createElement("A");BOOMR.utils.pluginConfig(impl,config,"AutoXHR",["spaBackEndResources","alwaysSendXhr"]);BOOMR.instrumentXHR=instrumentXHR;BOOMR.uninstrumentXHR=uninstrumentXHR;if(!impl.initialized){this.addExcludeFilter(shouldExcludeXhr,null,"shouldExcludeXhr");impl.initialized=!0}if(config&&config.AutoXHR&&config.AutoXHR.excludeFilters&&config.AutoXHR.excludeFilters.length>0)for(idx=0;idx<config.AutoXHR.excludeFilters.length;idx++)impl.excludeFilters.push(config.AutoXHR.excludeFilters[idx]);autoXhrEnabled=config.instrument_xhr;if(BOOMR.plugins.SPA&&BOOMR.plugins.SPA.supported_frameworks){var supported=BOOMR.plugins.SPA.supported_frameworks();for(i=0;i<supported.length;i++){var spa=supported[i];if(config[spa]&&config[spa].enabled){singlePageApp=!0;break}}}if(impl.alwaysSendXhr&&autoXhrEnabled&&BOOMR.xhr&&"function"==typeof BOOMR.xhr.stop){var resources=BOOMR.xhr.stop(sendXhrs);resources&&resources.length&&BOOMR.setImmediate(sendXhrs,resources)}if(singlePageApp){impl.alwaysSendXhr||(autoXhrEnabled=!1);autoXhrEnabled&&BOOMR.instrumentXHR()}else autoXhrEnabled?BOOMR.instrumentXHR():!1===autoXhrEnabled&&BOOMR.uninstrumentXHR();BOOMR.registerEvent("xhr_error");BOOMR.subscribe("beacon",impl.clear,null,impl)}},getMutationHandler:function(){return handler},getPathname:getPathName,enableAutoXhr:function(){autoXhrEnabled||BOOMR.instrumentXHR();autoXhrEnabled=!0},addExcludeFilter:function(cb,ctx,name){impl.excludeFilters.push({cb:cb,ctx:ctx,name:name})}}}}}();!function(w){var d,impl;if(!BOOMR.plugins.RT){impl={onloadfired:!1,unloadfired:!1,visiblefired:!1,initialized:!1,complete:!1,autorun:!0,timers:{},cookie:"RT",cookie_exp:604800,strict_referrer:!0,navigationType:0,navigationStart:void 0,responseStart:void 0,t_start:void 0,cached_t_start:void 0,cached_xhr_start:void 0,t_fb_approx:void 0,r:void 0,r2:void 0,basic_timers:{t_done:1,t_resp:1,t_page:1},crossdomain_sending:!1,addedVars:[],updateCookie:function(params,timer){var t_end,t_start,subcookies,k;if(!this.cookie)return!1;subcookies=BOOMR.utils.getSubCookies(BOOMR.utils.getCookie(this.cookie))||{};if("object"==typeof params)for(k in params)if(params.hasOwnProperty(k))if(void 0===params[k])subcookies.hasOwnProperty(k)&&delete subcookies[k];else{"nu"!==k&&"r"!==k||(params[k]=BOOMR.utils.hashQueryString(params[k],!0));subcookies[k]=params[k]}t_start=BOOMR.now();if(timer){subcookies[timer]=t_start;impl.lastActionTime=t_start}BOOMR.debug("Setting cookie (timer="+timer+")\n"+BOOMR.utils.objectToString(subcookies),"rt");if(!BOOMR.utils.setCookie(this.cookie,subcookies,this.cookie_exp)){BOOMR.error("cannot set start cookie","rt");return!1}t_end=BOOMR.now();if(t_end-t_start>50){BOOMR.utils.removeCookie(this.cookie);BOOMR.error("took more than 50ms to set cookie... aborting: "+t_start+" -> "+t_end,"rt")}return!0},initFromCookie:function(){var url,subcookies;subcookies=BOOMR.utils.getSubCookies(BOOMR.utils.getCookie(this.cookie));if(subcookies){subcookies.s=Math.max(+subcookies.ld||0,Math.max(+subcookies.ul||0,+subcookies.cl||0));BOOMR.debug("Read from cookie "+BOOMR.utils.objectToString(subcookies),"rt");if(subcookies.s&&(subcookies.r||subcookies.nu)){this.r=subcookies.r;url=BOOMR.utils.hashQueryString(d.URL,!0);BOOMR.debug(this.r+" =?= "+this.r2,"rt");BOOMR.debug(subcookies.s+" <? "+(+subcookies.cl+15),"rt");BOOMR.debug(subcookies.nu+" =?= "+url,"rt");if(!this.strict_referrer||subcookies.nu&&subcookies.nu===url&&subcookies.s<+subcookies.cl+15||subcookies.s===+subcookies.ul&&this.r===this.r2){this.t_start=subcookies.s;+subcookies.hd>subcookies.s&&(this.t_fb_approx=parseInt(subcookies.hd,10))}else this.t_start=this.t_fb_approx=void 0}this.updateCookie({s:void 0,r:void 0,nu:void 0,ul:void 0,cl:void 0,hd:void 0,ld:void 0,rl:void 0})}},getBoomerangTimings:function(){function trimTiming(time,st){var timeMs=Math.round(time||0),startTimeMs=Math.round(st||0);timeMs=0===timeMs?0:timeMs-startTimeMs;return timeMs||""}var res,urls,url,startTime,data;if(BOOMR.t_start){BOOMR.plugins.RT.startTimer("boomerang",BOOMR.t_start);BOOMR.plugins.RT.endTimer("boomerang",BOOMR.t_end);BOOMR.plugins.RT.endTimer("boomr_fb",BOOMR.t_start);if(BOOMR.t_lstart){BOOMR.plugins.RT.endTimer("boomr_ld",BOOMR.t_lstart);BOOMR.plugins.RT.setTimer("boomr_lat",BOOMR.t_start-BOOMR.t_lstart)}}try{if(window&&"performance"in window&&window.performance&&"function"==typeof window.performance.getEntriesByName){urls={"rt.bmr":BOOMR.url};for(url in urls)if(urls.hasOwnProperty(url)&&urls[url]){res=window.performance.getEntriesByName(urls[url]);if(!res||0===res.length||!res[0])continue;res=res[0];startTime=trimTiming(res.startTime,0);data=[startTime,trimTiming(res.responseEnd,startTime),trimTiming(res.responseStart,startTime),trimTiming(res.requestStart,startTime),trimTiming(res.connectEnd,startTime),trimTiming(res.secureConnectionStart,startTime),trimTiming(res.connectStart,startTime),trimTiming(res.domainLookupEnd,startTime),trimTiming(res.domainLookupStart,startTime),trimTiming(res.redirectEnd,startTime),trimTiming(res.redirectStart,startTime)].join(",").replace(/,+$/,"");BOOMR.addVar(url,data);impl.addedVars.push(url)}}}catch(e){BOOMR.addError(e,"rt.getBoomerangTimings")}},checkPreRender:function(){if("prerender"!==BOOMR.visibilityState())return!1;BOOMR.plugins.RT.startTimer("t_load",this.navigationStart);BOOMR.plugins.RT.endTimer("t_load");BOOMR.plugins.RT.startTimer("t_prerender",this.navigationStart);BOOMR.plugins.RT.startTimer("t_postrender");return!0},initFromNavTiming:function(){var ti,p,source;if(!this.navigationStart){p=BOOMR.getPerformance();p&&p.navigation&&(this.navigationType=p.navigation.type);if(p&&p.timing)ti=p.timing;else if(w.chrome&&w.chrome.csi&&w.chrome.csi().startE){ti={navigationStart:w.chrome.csi().startE};source="csi"}else if(w.gtbExternal&&w.gtbExternal.startE()){ti={navigationStart:w.gtbExternal.startE()};source="gtb"}if(ti){BOOMR.addVar("rt.start",source||"navigation");this.navigationStart=ti.navigationStart||ti.fetchStart||void 0;this.fetchStart=ti.fetchStart||void 0;this.responseStart=ti.responseStart||void 0;navigator.userAgent.match(/Firefox\/[78]\./)&&(this.navigationStart=ti.unloadEventStart||ti.fetchStart||void 0)}else BOOMR.warn("This browser doesn't support the WebTiming API","rt")}},validateLoadTimestamp:function(t_now,data,ename){var p;if(data&&data.timing&&data.timing.loadEventEnd)return data.timing.loadEventEnd;if(!("xhr"!==ename||data&&BOOMR.utils.inArray(data.initiator,BOOMR.constants.BEACON_TYPE_SPAS)))return t_now;p=BOOMR.getPerformance();return p&&p.timing?p.timing.loadEventEnd?p.timing.loadEventEnd:t_now:BOOMR.t_onload||BOOMR.t_lstart||BOOMR.t_start||t_now},setPageLoadTimers:function(ename,t_done,data){var t_resp_start,t_fetch_start;if("xhr"!==ename){impl.initFromCookie();impl.initFromNavTiming();if(impl.checkPreRender())return!1}if("xhr"===ename){if(data.timers)for(var timerName in data.timers)data.timers.hasOwnProperty(timerName)&&BOOMR.plugins.RT.setTimer(timerName,data.timers[timerName]);else if(data&&data.timing){t_fetch_start=data.timing.fetchStart;(void 0===t_fetch_start||data.timing.responseEnd>=t_fetch_start)&&(t_resp_start=data.timing.responseEnd)}}else impl.responseStart?impl.responseStart>=impl.navigationStart&&impl.responseStart>=impl.fetchStart&&(t_resp_start=impl.responseStart):impl.timers.hasOwnProperty("t_page")?BOOMR.plugins.RT.endTimer("t_page"):impl.t_fb_approx&&(t_resp_start=impl.t_fb_approx);if(t_resp_start){t_fetch_start?BOOMR.plugins.RT.setTimer("t_resp",t_fetch_start,t_resp_start):BOOMR.plugins.RT.endTimer("t_resp",t_resp_start);"load"===ename&&impl.timers.t_load?BOOMR.plugins.RT.setTimer("t_page",impl.timers.t_load.end-t_resp_start):t_done<t_resp_start?BOOMR.addVar("t_page.inv",1):BOOMR.plugins.RT.setTimer("t_page",t_done-t_resp_start)}if("load"===ename&&impl.timers.hasOwnProperty("t_postrender")){BOOMR.plugins.RT.endTimer("t_postrender");BOOMR.plugins.RT.endTimer("t_prerender")}return!0},setSupportingTimestamps:function(t_start){t_start&&BOOMR.addVar("rt.tstart",t_start);"number"==typeof impl.navigationStart&&impl.navigationStart!==t_start&&BOOMR.addVar("rt.nstart",impl.navigationStart);"number"==typeof impl.t_start&&impl.t_start!==t_start&&BOOMR.addVar("rt.cstart",impl.t_start);BOOMR.addVar("rt.bstart",BOOMR.t_start);BOOMR.t_lstart&&BOOMR.addVar("rt.blstart",BOOMR.t_lstart);BOOMR.addVar("rt.end",impl.timers.t_done.end)},determineTStart:function(ename,data){var t_start;if("xhr"===ename){data&&data.name&&impl.timers[data.name]?t_start=impl.timers[data.name].start:data&&data.timing&&data.timing.requestStart&&(t_start=data.timing.requestStart);void 0===t_start&&data&&BOOMR.utils.inArray(data.initiator,BOOMR.constants.BEACON_TYPE_SPAS)?BOOMR.addVar("rt.start","none"):BOOMR.addVar("rt.start","manual");impl.cached_xhr_start=t_start}else{if(impl.navigationStart)t_start=impl.navigationStart;else if(impl.t_start&&2!==impl.navigationType){t_start=impl.t_start;BOOMR.addVar("rt.start","cookie")}else if(impl.cached_t_start)t_start=impl.cached_t_start;else{BOOMR.addVar("rt.start","none");t_start=void 0}impl.cached_t_start=t_start}BOOMR.debug("Got start time: "+t_start,"rt");return t_start},page_ready:function(){this.onloadfired=!0},check_visibility:function(){"visible"===BOOMR.visibilityState()&&(impl.visiblefired=!0)},prerenderToVisible:function(){if(impl.onloadfired&&impl.autorun){BOOMR.debug("Transitioned from prerender to "+BOOMR.visibilityState(),"rt");BOOMR.addVar("vis.pre","1");BOOMR.plugins.RT.done(null,"visible")}},page_unload:function(edata){BOOMR.debug("Unload called when unloadfired = "+this.unloadfired,"rt");this.unloadfired||BOOMR.plugins.RT.done(edata,"unload");this.updateCookie({r:d.URL},"beforeunload"===edata.type?"ul":"hd");this.unloadfired=!0},_iterable_click:function(name,element,etarget,value_cb){var value;if(etarget){BOOMR.debug(name+" called with "+etarget.nodeName,"rt");for(;etarget&&etarget.nodeName.toUpperCase()!==element;)etarget=etarget.parentNode;if(etarget&&etarget.nodeName.toUpperCase()===element){BOOMR.debug("passing through","rt");value=value_cb(etarget);this.updateCookie({nu:value},"cl");BOOMR.addVar("nu",BOOMR.utils.cleanupURL(value));impl.addedVars.push("nu")}}},onclick:function(etarget){impl._iterable_click("Click","A",etarget,function(t){return t.href})},markComplete:function(){this.onloadfired&&(impl.complete=!0)},onsubmit:function(etarget){impl._iterable_click("Submit","FORM",etarget,function(t){var v=t.getAttribute("action")||d.URL||"";return v.match(/\?/)?v:v+"?"})},onconfig:function(config){config.beacon_url&&(impl.beacon_url=config.beacon_url);if(config.RT){config.RT.oboError&&!isNaN(config.RT.oboError)&&config.RT.oboError>impl.oboError&&(impl.oboError=config.RT.oboError);if(config.RT.loadTime&&!isNaN(config.RT.loadTime)&&config.RT.loadTime>impl.loadTime){impl.loadTime=config.RT.loadTime;isNaN(impl.timers.t_done.delta)||(impl.loadTime+=impl.timers.t_done.delta)}}},domloaded:function(){BOOMR.plugins.RT.endTimer("t_domloaded")},clear:function(){BOOMR.removeVar("rt.start");if(impl.addedVars&&impl.addedVars.length>0){BOOMR.removeVar(impl.addedVars);impl.addedVars=[]}},spaNavigation:function(){impl.onloadfired=!0}};BOOMR.plugins.RT={init:function(config){BOOMR.debug("init RT","rt");w!==BOOMR.window&&(w=BOOMR.window);config&&config.CrossDomain&&config.CrossDomain.sending&&(impl.crossdomain_sending=!0);if(w&&w.document){d=w.document;BOOMR.utils.pluginConfig(impl,config,"RT",["cookie","cookie_exp","session_exp","strict_referrer"]);config&&void 0!==config.autorun&&(impl.autorun=config.autorun);void 0!==d&&(impl.r=impl.r2=BOOMR.utils.hashQueryString(d.referrer,!0));impl.initFromCookie();if(impl.initialized)return this;impl.complete=!1;impl.timers={};impl.check_visibility();BOOMR.subscribe("page_ready",impl.page_ready,null,impl);BOOMR.subscribe("visibility_changed",impl.check_visibility,null,impl);BOOMR.subscribe("prerender_to_visible",impl.prerenderToVisible,null,impl);BOOMR.subscribe("page_ready",this.done,"load",this);BOOMR.subscribe("xhr_load",this.done,"xhr",this);BOOMR.subscribe("dom_loaded",impl.domloaded,null,impl);BOOMR.subscribe("page_unload",impl.page_unload,null,impl);BOOMR.subscribe("click",impl.onclick,null,impl);BOOMR.subscribe("form_submit",impl.onsubmit,null,impl);BOOMR.subscribe("before_beacon",this.addTimersToBeacon,"beacon",this);BOOMR.subscribe("beacon",impl.clear,null,impl);BOOMR.subscribe("error",impl.markComplete,null,impl);BOOMR.subscribe("config",impl.onconfig,null,impl);BOOMR.subscribe("spa_navigation",impl.spaNavigation,null,impl);BOOMR.subscribe("interaction",impl.markComplete,null,impl);BOOMR.getBeaconURL=function(){return impl.beacon_url};impl.initialized=!0;return this}},startTimer:function(timer_name,time_value){if(timer_name){"t_page"===timer_name&&this.endTimer("t_resp",time_value);impl.timers[timer_name]={start:"number"==typeof time_value?time_value:BOOMR.now()}}return this},endTimer:function(timer_name,time_value){if(timer_name){impl.timers[timer_name]=impl.timers[timer_name]||{};void 0===impl.timers[timer_name].end&&(impl.timers[timer_name].end="number"==typeof time_value?time_value:BOOMR.now())}return this},clearTimer:function(timer_name){timer_name&&delete impl.timers[timer_name];return this},setTimer:function(timer_name,time_delta_or_start,timer_end){timer_name&&(impl.timers[timer_name]=void 0!==timer_end?{start:time_delta_or_start,end:timer_end,delta:timer_end-time_delta_or_start}:{delta:time_delta_or_start});return this},addTimersToBeacon:function(vars,source){var t_name,timer,t_other=[];for(t_name in impl.timers)if(impl.timers.hasOwnProperty(t_name)){timer=impl.timers[t_name];if("number"!=typeof timer.delta){"number"!=typeof timer.start&&(timer.start="xhr"===source?impl.cached_xhr_start:impl.cached_t_start);timer.delta=timer.end-timer.start}if(isNaN(timer.delta))continue;if(impl.basic_timers.hasOwnProperty(t_name)){BOOMR.addVar(t_name,timer.delta);impl.addedVars.push(t_name)}else t_other.push(t_name+"|"+timer.delta)}if(t_other.length){BOOMR.addVar("t_other",t_other.join(","));impl.addedVars.push("t_other")}if("beacon"===source){impl.timers={};impl.complete=!1}},done:function(edata,ename){BOOMR.debug("Called done: "+ename,"rt");var t_start,t_done,t_now=BOOMR.now(),subresource=!1;impl.complete=!1;t_done=impl.validateLoadTimestamp(t_now,edata,ename);if(("load"===ename||"visible"===ename||"xhr"===ename)&&!impl.setPageLoadTimers(ename,t_done,edata))return this;("load"===ename||"visible"===ename||"xhr"===ename&&edata&&"spa_hard"===edata.initiator)&&impl.getBoomerangTimings();t_start=impl.determineTStart(ename,edata);this.endTimer("t_done",t_done);edata&&"xhr"===edata.initiator&&this.setTimer("t_done",edata.timing.requestStart,edata.timing.loadEventEnd);BOOMR.removeVar("t_done","t_page","t_resp","t_postrender","t_prerender","t_load","t_other","rt.tstart","rt.nstart","rt.cstart","rt.bstart","rt.end","rt.subres","http.errno","http.method","xhr.sync");impl.setSupportingTimestamps(t_start);this.addTimersToBeacon(null,ename);BOOMR.setReferrer(impl.r,impl.r2);"xhr"===ename&&edata&&edata&&edata.data&&(edata=edata.data);if("xhr"===ename&&edata){subresource=edata.subresource;if(edata.url){BOOMR.addVar("u",BOOMR.utils.cleanupURL(edata.url.replace(/#.*/,"")));impl.addedVars.push("u")}edata.status&&(edata.status<-1||edata.status>=400)&&BOOMR.addVar("http.errno",edata.status);edata.method&&"GET"!==edata.method&&BOOMR.addVar("http.method",edata.method);edata.headers&&BOOMR.addVar("http.hdr",edata.headers);edata.synchronous&&BOOMR.addVar("xhr.sync",1);edata.initiator&&BOOMR.addVar("http.initiator",edata.initiator);impl.addedVars.push("http.errno","http.method","http.hdr","xhr.sync","http.initiator")}if(subresource&&"passive"!==subresource){
BOOMR.addVar("rt.subres",1);impl.addedVars.push("rt.subres")}impl.updateCookie();if("unload"===ename){BOOMR.addVar("rt.quit","");if(!impl.onloadfired){BOOMR.addVar("rt.abld","");impl.addedVars.push("rt.abld")}impl.visiblefired||BOOMR.addVar("rt.ntvu","")}impl.complete=!0;BOOMR.sendBeacon(impl.beacon_url);return this},is_complete:function(vars){return impl.complete||vars&&"error"===vars["http.initiator"]},updateCookie:function(){impl.updateCookie()},navigationStart:function(){impl.navigationStart||impl.initFromNavTiming();return impl.navigationStart}}}}(window);!function(){if(!BOOMR.plugins.PaintTiming){var PAINT_TIMING_MAP={"first-paint":"fp","first-contentful-paint":"fcp"},impl={initialized:!1,complete:!1,supported:null,timingCache:{},done:function(){var p,paintTimings,i;if(this.complete)return this;p=BOOMR.getPerformance();if(p&&"function"==typeof p.getEntriesByType){paintTimings=p.getEntriesByType("paint");if(paintTimings&&paintTimings.length){BOOMR.info("This user agent supports PaintTiming","pt");for(i=0;i<paintTimings.length;i++){impl.timingCache[paintTimings[i].name]=paintTimings[i].startTime;PAINT_TIMING_MAP[paintTimings[i].name]&&BOOMR.addVar("pt."+PAINT_TIMING_MAP[paintTimings[i].name],Math.floor(paintTimings[i].startTime),!0)}this.complete=!0;BOOMR.sendBeacon()}}else this.complete=!0}};BOOMR.plugins.PaintTiming={init:function(){if(!this.is_supported()){impl.complete=!0;impl.initialized=!0}if(!impl.initialized){BOOMR.subscribe("page_ready",impl.done,null,impl);BOOMR.subscribe("xhr_load",impl.done,null,impl);BOOMR.subscribe("before_unload",impl.done,null,impl);impl.initialized=!0}return this},is_complete:function(){return!0},is_enabled:function(){return impl.initialized&&this.is_supported()},is_supported:function(){var p;if(null!==impl.supported)return impl.supported;var p=BOOMR.getPerformance();impl.supported=p&&void 0!==window.PerformancePaintTiming&&"function"==typeof p.getEntriesByType;return impl.supported},getTimingFor:function(timingName){var p,paintTimings,i;if(impl.timingCache[timingName])return impl.timingCache[timingName];if(this.is_supported()){var p=BOOMR.getPerformance();if(p&&"function"==typeof p.getEntriesByType){paintTimings=p.getEntriesByType("paint");if(paintTimings&&paintTimings.length)for(i=0;i<paintTimings.length;i++)if(paintTimings[i].name===timingName){impl.timingCache[timingName]=paintTimings[i].startTime;return impl.timingCache[timingName]}}}}}}}();!function(){function calcNavTimingTimestamp(offset,val){if("number"==typeof val&&0!==val)return Math.floor((offset||0)+val)}if(!BOOMR.plugins.NavigationTiming){var impl={complete:!1,sendBeacon:function(){this.complete=!0;BOOMR.sendBeacon()},xhr_done:function(edata){var p;if(edata&&"spa_hard"===edata.initiator)impl.done(edata);else if(edata&&"spa"===edata.initiator)impl.sendBeacon();else{var res,k,data=(BOOMR.window,{});if(edata){edata.data&&(edata=edata.data);p=BOOMR.getPerformance();if(p&&edata.restiming){data={nt_red_st:edata.restiming.redirectStart,nt_red_end:edata.restiming.redirectEnd,nt_fet_st:edata.restiming.fetchStart,nt_dns_st:edata.restiming.domainLookupStart,nt_dns_end:edata.restiming.domainLookupEnd,nt_con_st:edata.restiming.connectStart,nt_con_end:edata.restiming.connectEnd,nt_req_st:edata.restiming.requestStart,nt_res_st:edata.restiming.responseStart,nt_res_end:edata.restiming.responseEnd};edata.restiming.secureConnectionStart&&(data.nt_ssl_st=edata.restiming.secureConnectionStart);for(k in data)if(data.hasOwnProperty(k)&&data[k]){data[k]+=p.timing.navigationStart;data[k]=Math.floor(data[k])}}if(edata.timing){res=edata.timing;data.nt_req_st||(data.nt_req_st=res.requestStart);data.nt_res_st||(data.nt_res_st=res.responseStart);data.nt_res_end||(data.nt_res_end=res.responseEnd);data.nt_domint=res.domInteractive;data.nt_domcomp=res.domComplete;data.nt_load_st=res.loadEventEnd;data.nt_load_end=res.loadEventEnd}for(k in data)data.hasOwnProperty(k)&&!data[k]&&delete data[k];BOOMR.addVar(data);try{impl.addedVars.push.apply(impl.addedVars,Object.keys(data))}catch(ignore){}impl.sendBeacon()}}},done:function(){var p,pn,chromeTimes,pt,paintTiming,w=BOOMR.window,data={},offset=0;if(this.complete)return this;impl.addedVars=[];p=BOOMR.getPerformance();if(p){if("function"==typeof p.getEntriesByType){pt=p.getEntriesByType("navigation");if(pt&&pt.length){BOOMR.info("This user agent supports NavigationTiming2","nt");pt=pt[0];offset=p.timing?p.timing.navigationStart:0}else pt=void 0}if(!pt&&p.timing){BOOMR.info("This user agent supports NavigationTiming","nt");pt=p.timing}if(pt){data={nt_nav_st:p.timing?p.timing.navigationStart:0,nt_red_st:calcNavTimingTimestamp(offset,pt.redirectStart),nt_red_end:calcNavTimingTimestamp(offset,pt.redirectEnd),nt_fet_st:calcNavTimingTimestamp(offset,pt.fetchStart),nt_dns_st:calcNavTimingTimestamp(offset,pt.domainLookupStart),nt_dns_end:calcNavTimingTimestamp(offset,pt.domainLookupEnd),nt_con_st:calcNavTimingTimestamp(offset,pt.connectStart),nt_con_end:calcNavTimingTimestamp(offset,pt.connectEnd),nt_req_st:calcNavTimingTimestamp(offset,pt.requestStart),nt_res_st:calcNavTimingTimestamp(offset,pt.responseStart),nt_res_end:calcNavTimingTimestamp(offset,pt.responseEnd),nt_domloading:calcNavTimingTimestamp(offset,pt.domLoading),nt_domint:calcNavTimingTimestamp(offset,pt.domInteractive),nt_domcontloaded_st:calcNavTimingTimestamp(offset,pt.domContentLoadedEventStart),nt_domcontloaded_end:calcNavTimingTimestamp(offset,pt.domContentLoadedEventEnd),nt_domcomp:calcNavTimingTimestamp(offset,pt.domComplete),nt_load_st:calcNavTimingTimestamp(offset,pt.loadEventStart),nt_load_end:calcNavTimingTimestamp(offset,pt.loadEventEnd),nt_unload_st:calcNavTimingTimestamp(offset,pt.unloadEventStart),nt_unload_end:calcNavTimingTimestamp(offset,pt.unloadEventEnd)};!data.nt_domloading&&p&&p.timing&&p.timing.domLoading&&(data.nt_domloading=p.timing.domLoading);pt.secureConnectionStart&&(data.nt_ssl_st=calcNavTimingTimestamp(offset,pt.secureConnectionStart));p.timing&&p.timing.msFirstPaint&&(data.nt_first_paint=p.timing.msFirstPaint);pt.workerStart&&(data.nt_worker_start=calcNavTimingTimestamp(offset,pt.workerStart));if(pt.decodedBodySize||pt.transferSize){data.nt_enc_size=pt.encodedBodySize;data.nt_dec_size=pt.decodedBodySize;data.nt_trn_size=pt.transferSize}pt.nextHopProtocol&&(data.nt_protocol=pt.nextHopProtocol)}if(!data.nt_first_paint&&BOOMR.plugins.PaintTiming){paintTiming=BOOMR.plugins.PaintTiming.getTimingFor("first-paint");paintTiming&&(data.nt_first_paint=calcNavTimingTimestamp(offset,paintTiming))}if((!data.nt_protocol||!data.nt_first_paint)&&w.chrome&&"function"==typeof w.chrome.loadTimes){chromeTimes=w.chrome.loadTimes();if(chromeTimes){data.nt_spdy=chromeTimes.wasFetchedViaSpdy?1:0;data.nt_cinf=chromeTimes.connectionInfo;"number"==typeof chromeTimes.firstPaintTime&&0!==chromeTimes.firstPaintTime&&(data.nt_first_paint=Math.round(1e3*chromeTimes.firstPaintTime))}}if(p.navigation){pn=p.navigation;data.nt_red_cnt=pn.redirectCount;data.nt_nav_type=pn.type}for(k in data)data.hasOwnProperty(k)&&void 0===data[k]&&delete data[k];BOOMR.addVar(data);if(pt&&(pt.requestStart&&pt.navigationStart&&pt.requestStart<pt.navigationStart||pt.responseStart&&pt.navigationStart&&pt.responseStart<pt.navigationStart||pt.responseStart&&pt.fetchStart&&pt.responseStart<pt.fetchStart||pt.navigationStart&&pt.fetchStart<pt.navigationStart||pt.responseEnd&&pt.responseEnd>BOOMR.now()+864e5)){BOOMR.addVar("nt_bad",1);impl.addedVars.push("nt_bad")}try{impl.addedVars.push.apply(impl.addedVars,Object.keys(data))}catch(ignore){}}impl.sendBeacon()},clear:function(){if(impl.addedVars&&impl.addedVars.length>0){BOOMR.removeVar(impl.addedVars);impl.addedVars=[]}this.complete=!1},prerenderToVisible:function(){this.complete=!1;this.done()}};BOOMR.plugins.NavigationTiming={init:function(){if(!impl.initialized){BOOMR.subscribe("page_ready",impl.done,null,impl);BOOMR.subscribe("prerender_to_visible",impl.prerenderToVisible,null,impl);BOOMR.subscribe("xhr_load",impl.xhr_done,null,impl);BOOMR.subscribe("before_unload",impl.done,null,impl);BOOMR.subscribe("beacon",impl.clear,null,impl);impl.initialized=!0}return this},is_complete:function(){return!0}}}}();!function(){function convertToTrie(entries){var url,urlFixed,i,value,letters,letter,cur,node,trie={};for(url in entries){urlFixed=url;for(i=0;i<impl.xssBreakWords.length;i++)urlFixed=urlFixed.replace(impl.xssBreakWords[i],"$1"+XSS_BREAK_DELIM+"$2");if(entries.hasOwnProperty(url)){value=entries[url];letters=urlFixed.split("");cur=trie;for(i=0;i<letters.length;i++){letter=letters[i];node=cur[letter];void 0===node?cur=cur[letter]=i===letters.length-1?value:{}:"string"==typeof node?cur=cur[letter]={"|":node}:i===letters.length-1?cur[letter]["|"]=value:cur=cur[letter]}}}return trie}function optimizeTrie(cur,top){var node,ret,topNode,num=0,keys=[];for(node in cur)cur.hasOwnProperty(node)&&keys.push(node);for(var i=0;i<keys.length;i++){node=keys[i];if("object"==typeof cur[node]){ret=optimizeTrie(cur[node],!1);if(ret){delete cur[node];if(node===XSS_BREAK_DELIM){node=ret.name;num++}else node+=ret.name;cur[node]=ret.value}}num++}if(1===num){if(top){topNode={};topNode[node]=cur[node];return topNode}return{name:node,value:cur[node]}}return!!top&&cur}function trimTiming(time,startTime){"number"!=typeof time&&(time=0);"number"!=typeof startTime&&(startTime=0);var timeMs=Math.round(time||0),startTimeMs=Math.round(startTime||0);return 0===timeMs?0:timeMs-startTimeMs}function isFrameAccessible(frame){try{frame.location&&frame.location.href;frame.document;if("performance"in frame&&frame.performance)return!0}catch(e){}return!1}function getNavStartTime(frame){var navStart=0;isFrameAccessible(frame)&&frame.performance.timing&&frame.performance.timing.navigationStart&&(navStart=frame.performance.timing.navigationStart);return navStart}function findPerformanceEntriesForFrame(frame,isTopWindow,offset,depth,frameDims){function readServerTiming(entry){return impl.serverTiming&&entry.serverTiming||[]}var i,navEntries,navStart,frameNavStart,frameOffset,subFrames,navEntry,t,rtEntry,visibleEntries,a,entries=[],scripts={},links={};void 0===isTopWindow&&(isTopWindow=!0);void 0===offset&&(offset=0);void 0===depth&&(depth=0);if(depth>10)return entries;try{if(!isFrameAccessible(frame))return entries;navStart=getNavStartTime(frame);visibleEntries=getVisibleEntries(frame,frameDims);a=frame.document.createElement("a");collectResources(a,scripts,"script");collectResources(a,links,"link");subFrames=frame.document.getElementsByTagName("iframe");if(subFrames&&subFrames.length)for(i=0;i<subFrames.length;i++){frameNavStart=getNavStartTime(subFrames[i].contentWindow);frameOffset=0;frameNavStart>navStart&&(frameOffset=offset+(frameNavStart-navStart));a.href=subFrames[i].src;entries=entries.concat(findPerformanceEntriesForFrame(subFrames[i].contentWindow,!1,frameOffset,depth+1,visibleEntries[a.href]))}if("function"!=typeof frame.performance.getEntriesByType)return entries;if(isTopWindow){navEntries=frame.performance.getEntriesByType("navigation");if(navEntries&&1===navEntries.length){navEntry=navEntries[0];entries.push({name:frame.location.href,startTime:0,initiatorType:"html",redirectStart:navEntry.redirectStart,redirectEnd:navEntry.redirectEnd,fetchStart:navEntry.fetchStart,domainLookupStart:navEntry.domainLookupStart,domainLookupEnd:navEntry.domainLookupEnd,connectStart:navEntry.connectStart,secureConnectionStart:navEntry.secureConnectionStart,connectEnd:navEntry.connectEnd,requestStart:navEntry.requestStart,responseStart:navEntry.responseStart,responseEnd:navEntry.responseEnd,workerStart:navEntry.workerStart,encodedBodySize:navEntry.encodedBodySize,decodedBodySize:navEntry.decodedBodySize,transferSize:navEntry.transferSize,serverTiming:readServerTiming(navEntry)})}else if(frame.performance.timing){t=frame.performance.timing;0!==t.navigationStart&&t.responseEnd<=t.navigationStart+36e5&&entries.push({name:frame.location.href,startTime:0,initiatorType:"html",redirectStart:t.redirectStart?t.redirectStart-t.navigationStart:0,redirectEnd:t.redirectEnd?t.redirectEnd-t.navigationStart:0,fetchStart:t.fetchStart?t.fetchStart-t.navigationStart:0,domainLookupStart:t.domainLookupStart?t.domainLookupStart-t.navigationStart:0,domainLookupEnd:t.domainLookupEnd?t.domainLookupEnd-t.navigationStart:0,connectStart:t.connectStart?t.connectStart-t.navigationStart:0,secureConnectionStart:t.secureConnectionStart?t.secureConnectionStart-t.navigationStart:0,connectEnd:t.connectEnd?t.connectEnd-t.navigationStart:0,requestStart:t.requestStart?t.requestStart-t.navigationStart:0,responseStart:t.responseStart?t.responseStart-t.navigationStart:0,responseEnd:t.responseEnd?t.responseEnd-t.navigationStart:0})}}var frameEntries=frame.performance.getEntriesByType("resource"),frameFixedEntries=[];for(i=0;frameEntries&&i<frameEntries.length;i++){t=frameEntries[i];rtEntry={name:t.name,initiatorType:t.initiatorType,startTime:t.startTime+offset,redirectStart:t.redirectStart?t.redirectStart+offset:0,redirectEnd:t.redirectEnd?t.redirectEnd+offset:0,fetchStart:t.fetchStart?t.fetchStart+offset:0,domainLookupStart:t.domainLookupStart?t.domainLookupStart+offset:0,domainLookupEnd:t.domainLookupEnd?t.domainLookupEnd+offset:0,connectStart:t.connectStart?t.connectStart+offset:0,secureConnectionStart:t.secureConnectionStart?t.secureConnectionStart+offset:0,connectEnd:t.connectEnd?t.connectEnd+offset:0,requestStart:t.requestStart?t.requestStart+offset:0,responseStart:t.responseStart?t.responseStart+offset:0,responseEnd:t.responseEnd?t.responseEnd+offset:0,workerStart:t.workerStart?t.workerStart+offset:0,encodedBodySize:t.encodedBodySize,decodedBodySize:t.decodedBodySize,transferSize:t.transferSize,serverTiming:readServerTiming(t),visibleDimensions:visibleEntries[t.name],latestTime:getResourceLatestTime(t)};if(("script"===t.initiatorType||"link"===t.initiatorType)&&scripts[t.name]){var s=scripts[t.name];rtEntry.scriptAttrs=(s.async?ASYNC_ATTR:0)|(s.defer?DEFER_ATTR:0);for(;1===s.nodeType&&"BODY"!==s.nodeName;)s=s.parentNode;rtEntry.scriptAttrs|="BODY"===s.nodeName?LOCAT_ATTR:0}"link"===t.initiatorType&&links[t.name]&&BOOMR.utils.arrayFind(links[t.name].rel.split(/[\u0009\u000A\u000C\u000D\u0020]+/),function(rel){rel=rel.toLowerCase();if(REL_TYPES[rel]){rtEntry.linkAttrs=REL_TYPES[rel];return!0}});frameFixedEntries.push(rtEntry)}entries=entries.concat(frameFixedEntries)}catch(e){return entries}return entries}function collectResources(a,obj,tagName){Array.prototype.forEach.call(a.ownerDocument.getElementsByTagName(tagName),function(r){a.href=r.src||r.href;a.href.match(/^https?:\/\//)&&(obj[a.href]=r)})}function toBase36(n){return"number"==typeof n&&0!==n?n.toString(36):"string"==typeof n?n:""}function getVisibleEntries(win,winDims){var x,y,els=["img","iframe","image"],entries={},doc=win.document,a=doc.createElement("A");winDims=winDims||[0,0,0,0];x=winDims[3]+(void 0!==win.pageXOffset)?win.pageXOffset:(doc.documentElement||doc.body.parentNode||doc.body).scrollLeft;y=winDims[2]+(void 0!==win.pageYOffset)?win.pageYOffset:(doc.documentElement||doc.body.parentNode||doc.body).scrollTop;els.forEach(function(elname){var el,i,rect,src,elements=doc.getElementsByTagName(elname);for(i=0;i<elements.length;i++){el=elements[i];if(el){src=el.src||el.getAttribute("src")||el.getAttribute("xlink:href");a.href=src;src=a.href;if(src&&!entries[src]){rect=el.getBoundingClientRect();if((rect.height||el.offsetHeight)&&(rect.width||el.offsetWidth)){entries[src]=[rect.height||el.offsetHeight,rect.width||el.offsetWidth,Math.round(rect.top+y),Math.round(rect.left+x)];!el.naturalHeight&&!el.naturalWidth||entries[src][0]===el.naturalHeight&&entries[src][1]===el.naturalWidth||entries[src].push(el.naturalHeight,el.naturalWidth)}}}}});return entries}function getFilteredResourceTiming(from,to,initiatorTypes){var i,e,entries=findPerformanceEntriesForFrame(BOOMR.window,!0,0,0),navStart=getNavStartTime(BOOMR.window),countCollector={};if(!entries||!entries.length)return{entries:[]};entries.sort(function(a,b){return a.startTime-b.startTime});var filteredEntries=[];for(i=0;i<entries.length;i++){e=entries[i];if(0!==e.name.indexOf("about:")&&0!==e.name.indexOf("javascript:")&&0!==e.name.indexOf("res:")&&!(e.name.indexOf(BOOMR.url)>-1||e.name.indexOf(BOOMR.config_url)>-1||"function"==typeof BOOMR.getBeaconURL&&BOOMR.getBeaconURL()&&e.name.indexOf(BOOMR.getBeaconURL())>-1||from&&navStart+e.startTime<from)){if(to&&navStart+e.startTime>to)break;if(void 0===initiatorTypes||"*"===initiatorTypes||!initiatorTypes.length||e.initiatorType&&BOOMR.utils.inArray(e.initiatorType,initiatorTypes)){accumulateServerTimingEntries(countCollector,e.serverTiming);filteredEntries.push(e)}}}var lookup=compressServerTiming(countCollector);return{entries:filteredEntries,serverTiming:{lookup:lookup,indexed:indexServerTiming(lookup)}}}function compressSize(resource){var sTrans,sEnc,sDec,sizes;if(resource.encodedBodySize||resource.decodedBodySize||resource.transferSize){sTrans=resource.transferSize;sEnc=resource.encodedBodySize;sDec=resource.decodedBodySize;sizes=[sEnc,sTrans?sTrans-sEnc:"_",sDec?sDec-sEnc:0];return sizes.map(toBase36).join(",").replace(/,+$/,"")}return""}function trimUrl(url,urlsToTrim){var i,urlIdx,trim;if(url&&urlsToTrim)for(i=0;i<urlsToTrim.length;i++){trim=urlsToTrim[i];if("string"==typeof trim){urlIdx=url.indexOf(trim);if(-1!==urlIdx){url=url.substr(0,urlIdx+trim.length)+"...";break}}else trim instanceof RegExp&&trim.test(url)&&(url=url.replace(trim,"$1")+"...")}return BOOMR.utils.cleanupURL(url,impl.urlLimit)}function getResourceLatestTime(res){return res.responseEnd?res.responseEnd:res.responseStart&&res.startTime?res.responseStart+.2*(res.responseStart-res.startTime):1/0}function getCompressedResourceTiming(from,to){var i,e,initiatorType,url,data,results={},timePoints={},ret=getFilteredResourceTiming(from,to,impl.trackedResourceTypes),entries=ret.entries,serverTiming=ret.serverTiming;if(!entries||!entries.length)return{restiming:{},servertiming:[]};for(i=0;i<entries.length;i++){e=entries[i];initiatorType=INITIATOR_TYPES[e.initiatorType];void 0===initiatorType&&(initiatorType=0);data=initiatorType+[trimTiming(e.startTime,0),trimTiming(e.responseEnd,e.startTime),trimTiming(e.responseStart,e.startTime),trimTiming(e.requestStart,e.startTime),trimTiming(e.connectEnd,e.startTime),trimTiming(e.secureConnectionStart,e.startTime),trimTiming(e.connectStart,e.startTime),trimTiming(e.domainLookupEnd,e.startTime),trimTiming(e.domainLookupStart,e.startTime),trimTiming(e.redirectEnd,e.startTime),trimTiming(e.redirectStart,e.startTime)].map(toBase36).join(",").replace(/,+$/,"");var compSize=compressSize(e);""!==compSize&&(data+=SPECIAL_DATA_PREFIX+SPECIAL_DATA_SIZE_TYPE+compSize);e.hasOwnProperty("scriptAttrs")&&(data+=SPECIAL_DATA_PREFIX+SPECIAL_DATA_SCRIPT_ATTR_TYPE+e.scriptAttrs);e.serverTiming&&e.serverTiming.length&&(data+=SPECIAL_DATA_PREFIX+SPECIAL_DATA_SERVERTIMING_TYPE+e.serverTiming.reduce(function(stData,entry,entryIndex){var duration=String(void 0!==entry.duration?entry.duration:entry.value);"0."===duration.substring(0,2)&&(duration=duration.substring(1));var name=entry.name||entry.metric,lookupKey=identifyServerTimingEntry(serverTiming.indexed[name].index,serverTiming.indexed[name].descriptions[entry.description]);stData+=(entryIndex>0?",":"")+duration+lookupKey;return stData},""));e.hasOwnProperty("linkAttrs")&&(data+=SPECIAL_DATA_PREFIX+SPECIAL_DATA_LINK_ATTR_TYPE+e.linkAttrs);url=trimUrl(e.name,impl.trimUrls);void 0!==results[url]?results[url]+="|"+data:e.visibleDimensions?results[url]=SPECIAL_DATA_PREFIX+SPECIAL_DATA_DIMENSION_TYPE+e.visibleDimensions.map(Math.round).map(toBase36).join(",").replace(/,+$/,"")+"|"+data:results[url]=data;if(e.visibleDimensions){timePoints[e.latestTime]||(timePoints[e.latestTime]=[]);timePoints[e.latestTime].push(e.visibleDimensions)}}return{restiming:optimizeTrie(convertToTrie(results),!0),servertiming:serverTiming.lookup}}function reduceFetchStarts(resources){var times=[];if(!resources||!resources.length)return times;for(var i=0;i<resources.length;i++){var res=resources[i];i!==resources.length-1&&res.fetchStart===resources[i+1].fetchStart||times.push({fetchStart:res.fetchStart,responseEnd:res.responseStart||res.responseEnd})}return times}function calculateResourceTimingUnion(resources){var i;if(!resources||!resources.length)return 0;resources.sort(function(a,b){return a.fetchStart!==b.fetchStart?a.fetchStart-b.fetchStart:(a.responseStart||a.responseEnd)-(b.responseStart||b.responseEnd)});var times=reduceFetchStarts(resources),times2=[],furthestEnd=0;for(i=0;i<times.length;i++){var res=times[i];res.fetchStart<furthestEnd&&(res.fetchStart=furthestEnd);if(res.fetchStart<res.responseEnd){times2.push(res);furthestEnd=res.responseEnd}}var times3=reduceFetchStarts(times2),totalTime=0;for(i=0;i<times3.length;i++)totalTime+=times3[i].responseEnd-times3[i].fetchStart;return totalTime}function addResourceTimingToBeacon(from,to){var r;if("undefined"!=typeof JSON){BOOMR.removeVar("restiming");BOOMR.removeVar("servertiming");r=getCompressedResourceTiming(from,to);if(r){BOOMR.info("Client supports Resource Timing API","restiming");addToBeacon(r)}}}function accumulateServerTimingEntries(countCollector,serverTimingEntries){(serverTimingEntries||[]).forEach(function(entry){var name=entry.name||entry.metric;void 0===countCollector[name]&&(countCollector[name]={count:0,counts:{}});var metric=countCollector[name];metric.counts[entry.description]=metric.counts[entry.description]||0;metric.counts[entry.description]++;metric.count++})}function compressServerTiming(countCollector){return Object.keys(countCollector).sort(function(metric1,metric2){return countCollector[metric2].count-countCollector[metric1].count}).reduce(function(array,name){var sorted=Object.keys(countCollector[name].counts).sort(function(description1,description2){return countCollector[name].counts[description2]-countCollector[name].counts[description1]});array.push(1===sorted.length&&""===sorted[0]?name:[name].concat(sorted));return array},[])}function indexServerTiming(lookup){return lookup.reduce(function(serverTimingIndex,compressedEntry,entryIndex){var name,descriptions;if(Array.isArray(compressedEntry)){name=compressedEntry[0];descriptions=compressedEntry.slice(1).reduce(function(descriptionCollector,description,descriptionIndex){descriptionCollector[description]=descriptionIndex;return descriptionCollector},{})}else{name=compressedEntry;descriptions={"":0}}serverTimingIndex[name]={index:entryIndex,descriptions:descriptions};return serverTimingIndex},{})}function identifyServerTimingEntry(entryIndex,descriptionIndex){var s="";entryIndex&&(s+=entryIndex);descriptionIndex&&(s+="."+descriptionIndex);s.length&&(s=":"+s);return s}function addToBeacon(r){BOOMR.addVar("restiming",JSON.stringify(r.restiming));r.servertiming.length&&BOOMR.addVar("servertiming",BOOMR.utils.serializeForUrl(r.servertiming))}var impl;if(!BOOMR.plugins.ResourceTiming){var INITIATOR_TYPES={other:0,img:1,link:2,script:3,css:4,xmlhttprequest:5,html:6,image:7,beacon:8,fetch:9,iframe:"a",subdocument:"a"},REL_TYPES={prefetch:1,preload:2,prerender:3,stylesheet:4},DEFAULT_XSS_BREAK_WORDS=[/(h)(ref)/gi,/(s)(rc)/gi,/(a)(ction)/gi],XSS_BREAK_DELIM="\n",SPECIAL_DATA_PREFIX="*",SPECIAL_DATA_DIMENSION_TYPE="0",SPECIAL_DATA_SIZE_TYPE="1",SPECIAL_DATA_SCRIPT_ATTR_TYPE="2",ASYNC_ATTR=1,DEFER_ATTR=2,LOCAT_ATTR=4,SPECIAL_DATA_SERVERTIMING_TYPE="3",SPECIAL_DATA_LINK_ATTR_TYPE="4";impl={complete:!1,sentNavBeacon:!1,initialized:!1,supported:null,xhr_load:function(){if(!this.complete){this.complete=!0;BOOMR.sendBeacon()}},xssBreakWords:DEFAULT_XSS_BREAK_WORDS,urlLimit:500,clearOnBeacon:!1,trimUrls:[],trackedResourceTypes:"*",serverTiming:!0,done:function(){if(!this.sentNavBeacon){addResourceTimingToBeacon();this.complete=!0;this.sentNavBeacon=!0;BOOMR.sendBeacon()}},onBeacon:function(vars){var p=BOOMR.getPerformance();vars.hasOwnProperty("restiming")&&BOOMR.removeVar("restiming");vars.hasOwnProperty("servertiming")&&BOOMR.removeVar("servertiming");if(impl.clearOnBeacon&&p){var clearResourceTimings=p.clearResourceTimings||p.webkitClearResourceTimings;clearResourceTimings&&"function"==typeof clearResourceTimings&&clearResourceTimings.call(p)}},prerenderToVisible:function(){this.sentNavBeacon=!1;this.done()}};BOOMR.plugins.ResourceTiming={init:function(config){BOOMR.utils.pluginConfig(impl,config,"ResourceTiming",["xssBreakWords","clearOnBeacon","urlLimit","trimUrls","trackedResourceTypes","serverTiming"]);if(impl.initialized)return this;if(this.is_supported()){BOOMR.subscribe("page_ready",impl.done,null,impl);BOOMR.subscribe("prerender_to_visible",impl.prerenderToVisible,null,impl);BOOMR.subscribe("xhr_load",impl.xhr_load,null,impl);BOOMR.subscribe("beacon",impl.onBeacon,null,impl);BOOMR.subscribe("before_unload",impl.done,null,impl)}else impl.complete=!0;impl.initialized=!0;return this},is_complete:function(){return!0},is_enabled:function(){return impl.initialized&&this.is_supported()},is_supported:function(){var p;if(null!==impl.supported)return impl.supported;var p=BOOMR.getPerformance();impl.supported=p&&"function"==typeof p.getEntriesByType&&void 0!==window.PerformanceResourceTiming;return impl.supported},getCompressedResourceTiming:getCompressedResourceTiming,getFilteredResourceTiming:getFilteredResourceTiming,calculateResourceTimingUnion:calculateResourceTimingUnion,addResourceTimingToBeacon:addResourceTimingToBeacon,addToBeacon:addToBeacon}}}();!function(root,factory){"use strict";root.ErrorStackParser=factory()}(window,function(){"use strict";function _map(array,fn,thisArg){if("function"==typeof Array.prototype.map)return array.map(fn,thisArg);for(var output=new Array(array.length),i=0;i<array.length;i++)output[i]=fn.call(thisArg,array[i]);return output}function _filter(array,fn,thisArg){if("function"==typeof Array.prototype.filter)return array.filter(fn,thisArg);for(var output=[],i=0;i<array.length;i++)fn.call(thisArg,array[i])&&output.push(array[i]);return output}var FIREFOX_SAFARI_STACK_REGEXP=/(^|@)\S+\:\d+/,CHROME_IE_STACK_REGEXP=/^\s*at .*(\S+\:\d+|\(native\))/m,SAFARI_NATIVE_CODE_REGEXP=/^(eval@)?(\[native code\])?$/;return{parse:function(error){if(void 0!==error.stacktrace||void 0!==error["opera#sourceloc"])return this.parseOpera(error);if(error.stack&&error.stack.match(CHROME_IE_STACK_REGEXP))return this.parseV8OrIE(error);if(error.stack)return this.parseFFOrSafari(error);throw new Error("Cannot parse given Error object")},extractLocation:function(urlLike){if(-1===urlLike.indexOf(":"))return[urlLike];var locationParts=urlLike.replace(/[\(\)\s]/g,"").split(":"),lastNumber=locationParts.pop(),possibleNumber=locationParts[locationParts.length-1];if(!isNaN(parseFloat(possibleNumber))&&isFinite(possibleNumber)){var lineNumber=locationParts.pop();return[locationParts.join(":"),lineNumber,lastNumber]}return[locationParts.join(":"),lastNumber,void 0]},parseV8OrIE:function(error){return _map(_filter(error.stack.split("\n"),function(line){return!!line.match(CHROME_IE_STACK_REGEXP)},this),function(line){line.indexOf("(eval ")>-1&&(line=line.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var tokens=line.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),locationParts=this.extractLocation(tokens.pop());return{functionName:tokens.join(" ")||void 0,fileName:"eval"===locationParts[0]?void 0:locationParts[0],lineNumber:locationParts[1],columnNumber:locationParts[2],source:line}},this)},parseFFOrSafari:function(error){return _map(_filter(error.stack.split("\n"),function(line){return!line.match(SAFARI_NATIVE_CODE_REGEXP)},this),function(line){line.indexOf(" > eval")>-1&&(line=line.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1"));if(-1===line.indexOf("@")&&-1===line.indexOf(":"))return{functionName:line};var tokens=line.split("@"),locationParts=this.extractLocation(tokens.pop());return{functionName:tokens.join("@")||void 0,fileName:locationParts[0],lineNumber:locationParts[1],columnNumber:locationParts[2],source:line}},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var lineRE=/Line (\d+).*script (?:in )?(\S+)/i,lines=e.message.split("\n"),result=[],i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);match&&result.push({fileName:match[2],lineNumber:match[1],source:lines[i]})}return result},parseOpera10:function(e){for(var lineRE=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,lines=e.stacktrace.split("\n"),result=[],i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);match&&result.push({functionName:match[3]||void 0,fileName:match[2],lineNumber:match[1],source:lines[i]})}return result},parseOpera11:function(error){return _map(_filter(error.stack.split("\n"),function(line){return!!line.match(FIREFOX_SAFARI_STACK_REGEXP)&&!line.match(/^Error created at/)},this),function(line){var argsRaw,tokens=line.split("@"),locationParts=this.extractLocation(tokens.pop()),functionCall=tokens.shift()||"",functionName=functionCall.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;functionCall.match(/\(([^\)]*)\)/)&&(argsRaw=functionCall.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));return{functionName:functionName,args:void 0===argsRaw||"[arguments not available]"===argsRaw?void 0:argsRaw.split(","),fileName:locationParts[0],lineNumber:locationParts[1],columnNumber:locationParts[2],source:line}},this)}}});!function(){function BoomerangError(config){config=config||{};"number"==typeof config.count||"string"==typeof config.count?this.count=parseInt(config.count,10):this.count=1;"number"==typeof config.timestamp?this.timestamp=config.timestamp:this.timestamp=BOOMR.now();"number"!=typeof config.code&&"string"!=typeof config.code||(this.code=parseInt(config.code,10));"string"==typeof config.message&&(this.message=config.message);"string"==typeof config.functionName&&(this.functionName=config.functionName);"string"==typeof config.fileName&&(this.fileName=config.fileName);"number"!=typeof config.lineNumber&&"string"!=typeof config.lineNumber||(this.lineNumber=parseInt(config.lineNumber,10));"number"!=typeof config.columnNumber&&"string"!=typeof config.columnNumber||(this.columnNumber=parseInt(config.columnNumber,10));"string"==typeof config.stack&&(this.stack=config.stack);"string"==typeof config.type&&(this.type=config.type);void 0!==config.extra&&(this.extra=config.extra);this.source="number"==typeof config.source||"string"==typeof config.source?parseInt(config.source,10):BOOMR.plugins.Errors.SOURCE_APP;"number"!=typeof config.via&&"string"!=typeof config.via||(this.via=parseInt(config.via,10));BOOMR.utils.isArray(config.frames)?this.frames=config.frames:this.frames=[];BOOMR.utils.isArray(config.events)?this.events=config.events:this.events=[]}var impl;if(!BOOMR.plugins.Errors){var STACK_FUNCTIONS_REMOVE=["BOOMR_addError","createStackForSend","BOOMR.window.console.error","BOOMR.plugins.Errors.init","BOOMR.window.onerror","BOOMR_plugins_errors_"],STACK_FUNCTIONS_REMOVE_IF_FILENAME_MATCH=["Object.send","b.send","wrap","Anonymous function"],STACK_FILENAME_MATCH=["/boomerang"],MAX_STACK_SIZE=5e3;BoomerangError.prototype.equals=function(other){return"object"==typeof other&&(this.code===other.code&&(this.message===other.message&&(this.functionName===other.functionName&&(this.fileName===other.fileName&&(this.lineNumber===other.lineNumber&&(this.columnNumber===other.columnNumber&&(this.stack===other.stack&&(this.type===other.type&&this.source===other.source))))))))};BoomerangError.fromError=function(error,via,source){var frame,frames,i,j,k,skipThis,thisFrame,thisFn,forceUpdate=!1,now=BOOMR.now();if(!error)return null;if(error.stack){error.stack.length>MAX_STACK_SIZE&&(error.stack=error.stack.substr(0,MAX_STACK_SIZE));frames=ErrorStackParser.parse(error);if(frames&&frames.length){if(error.generatedStack){
if(frames.length>=4&&frames[1].functionName&&-1!==frames[1].functionName.indexOf("createStackForSend")){frames=frames.slice(3);forceUpdate=!0}if(frames.length>=3&&frames[0].functionName&&-1!==frames[0].functionName.indexOf("createStackForSend")){frames=frames[1].fileName===frames[2].fileName?frames.slice(3):frames.slice(2);forceUpdate=!0}if(frames.length>=1&&frames[0].functionName&&-1!==frames[0].functionName.indexOf("BOOMR_plugins_errors")){frames=frames.slice(1);forceUpdate=!0}}for(i=0;i<frames.length;i++){thisFrame=frames[i];thisFn=thisFrame.functionName;skipThis=!1;if(thisFn){for(j=0;j<STACK_FUNCTIONS_REMOVE.length;j++)if(-1!==thisFn.indexOf(STACK_FUNCTIONS_REMOVE[j])){frames.splice(i,1);forceUpdate=!0;i--;skipThis=!0;break}if(!skipThis&&thisFrame.fileName)for(j=0;j<STACK_FILENAME_MATCH.length;j++)if(-1!==thisFrame.fileName.indexOf(STACK_FILENAME_MATCH[j]))for(k=0;k<STACK_FUNCTIONS_REMOVE_IF_FILENAME_MATCH.length;k++)if(-1!==thisFn.indexOf(STACK_FUNCTIONS_REMOVE_IF_FILENAME_MATCH[k])){frames.splice(i,1);forceUpdate=!0;i--;skipThis=!0;break}}}if(frames.length){frame=frames[0];(forceUpdate||void 0===error.lineNumber)&&(error.lineNumber=frame.lineNumber);(forceUpdate||void 0===error.columnNumber)&&(error.columnNumber=frame.columnNumber);(forceUpdate||void 0===error.functionName)&&(error.functionName=frame.functionName);(forceUpdate||void 0===error.fileName)&&(error.fileName=frame.fileName)}error.stack&&(error.stack=error.stack.replace(/\s\s+/g," "))}}else(error.functionName||error.fileName||error.lineNumber||error.columnNumber)&&(frames=[{lineNumber:error.lineNumber,columnNumber:error.columnNumber,fileName:error.fileName,functionName:error.functionName}]);error.message&&-1!==error.message.indexOf("ReferenceError:")&&"Error"===error.name&&(error.name="ReferenceError");return new BoomerangError({code:error.code?error.code:void 0,message:error.message?error.message:void 0,functionName:error.functionName?error.functionName:void 0,fileName:error.fileName?error.fileName:void 0,lineNumber:error.lineNumber?error.lineNumber:void 0,columnNumber:error.columnNumber?error.columnNumber:void 0,stack:error.stack?error.stack:void 0,type:error.name?error.name:void 0,source:source,via:via,frames:frames,extra:error.extra?error.extra:void 0,timestamp:error.timestamp?error.timestamp:now})};impl={onError:void 0,monitorGlobal:!0,monitorNetwork:!0,monitorConsole:!0,monitorEvents:!0,monitorTimeout:!0,sendAfterOnload:!1,maxErrors:10,sendInterval:1e3,sendIntervalDuringLoad:2500,sendIntervalId:-1,maxEvents:10,imageErrors:!0,isDuringLoad:!0,initialized:!1,supported:!1,autorun:!0,errors:[],q:[],events:[],send:function(error,via,source){function createStackForSend(){try{throw Error(error)}catch(ex){error=ex;error.generatedStack=!0;error.timestamp=error.timestamp||now;impl.addError(error,via,source)}}var now=BOOMR.now();if(error&&!0!==error.reported){error.reported=!0;via=via||BOOMR.plugins.Errors.VIA_APP;source=source||BOOMR.plugins.Errors.SOURCE_APP;if(error.stack||error.noStack){error.timestamp=error.timestamp||now;impl.addError(error,via,source)}else createStackForSend()}},addError:function(error,via,source){var onErrorResult,err,dup=!1,now=BOOMR.now();if(impl.isDuringLoad||impl.sendAfterOnload){if(impl.onError){try{onErrorResult=impl.onError(error)}catch(exc){onErrorResult=!1}if(!onErrorResult)return}if(!(impl.errors.length>=impl.maxErrors)){err=BoomerangError.fromError(error,via,source);dup=impl.mergeDuplicateErrors(impl.errors,err,!1);BOOMR.fireEvent("error",dup||err);impl.mergeDuplicateErrors(impl.q,err,!0);if(!(impl.isDuringLoad&&impl.autorun||-1!==impl.sendIntervalId)){if(dup)return;impl.sendIntervalId=setTimeout(function(){impl.sendIntervalId=-1;if(0!==impl.q.length){BOOMR.addVar("http.initiator","error");BOOMR.addVar("api",1);impl.addErrorsToBeacon();if(impl.isDuringLoad){BOOMR.addVar("rt.tstart",now);BOOMR.addVar("rt.end",now);BOOMR.addVar("rt.start","manual")}BOOMR.sendBeacon()}},impl.isDuringLoad?impl.sendIntervalDuringLoad:impl.sendInterval)}}}},findDuplicateError:function(errors,err){if(BOOMR.utils.isArray(errors)&&void 0!==err)for(var i=0;i<errors.length;i++)if(errors[i].equals(err))return errors[i]},mergeDuplicateErrors:function(errors,err,bumpCount){if(BOOMR.utils.isArray(errors)&&void 0!==err){var dup=impl.findDuplicateError(errors,err);if(dup){bumpCount&&(dup.count+=err.count);return dup}errors.push(err)}},onBeacon:function(){BOOMR.removeVar("err");BOOMR.removeVar("api");BOOMR.removeVar("http.initiator")},pageReady:function(){impl.isDuringLoad=!1},getErrors:function(){return 0!==impl.errors.length&&impl.errors},getErrorsForUrl:function(errors){errors=impl.compressErrors(errors);return BOOMR.utils.serializeForUrl(errors)},addErrorsToBeacon:function(){if(impl.q.length){var err=this.getErrorsForUrl(impl.q);err&&BOOMR.addVar("err",err);impl.q=[]}},beforeBeacon:function(){impl.addErrorsToBeacon()},wrapFn:function(functionName,that,useCallingObject,callbackIndex,via){var origFn=that[functionName];if("function"==typeof origFn){var rEL;"addEventListener"===functionName&&(rEL=that.removeEventListener);that[functionName]=function(){try{var args=Array.prototype.slice.call(arguments),callbackFn=args[callbackIndex],targetObj=useCallingObject?this===window?BOOMR.window:this:that,wrappedFn=impl.wrap(callbackFn,targetObj,via);args[callbackIndex]=wrappedFn;if("addEventListener"===functionName){if(!impl.trackFn(targetObj,args[0],callbackFn,args[2],wrappedFn))return;rEL&&rEL.apply(targetObj,arguments)}return origFn.apply(targetObj,args)}catch(e){impl.send(e,via);throw e}}}},trackFn:function(target,type,listener,useCapture,wrapped){if(!target)return!1;if(-1!==impl.trackedFnIdx(target,type,listener,useCapture))return!1;target._bmrEvents||(target._bmrEvents=[]);useCapture=!0===(useCapture&&useCapture.capture||useCapture);target._bmrEvents.push([type,listener,useCapture,wrapped]);return!0},trackedFnIdx:function(target,type,listener,useCapture){var i,f;if(target){target._bmrEvents||(target._bmrEvents=[]);useCapture=!0===(useCapture&&useCapture.capture||useCapture);for(i=0;i<target._bmrEvents.length;i++){f=target._bmrEvents[i];if(f[0]===type&&f[1]===listener&&f[2]===useCapture)return i}return-1}},wrapRemoveEventListener:function(that){var idx,wrappedFn,fn="removeEventListener",origFn=that[fn];"function"==typeof origFn&&(that[fn]=function(type,listener,useCapture){idx=impl.trackedFnIdx(this,type,listener,useCapture);if(-1!==idx){wrappedFn=this._bmrEvents[idx][3];origFn.call(this,type,wrappedFn,useCapture);this._bmrEvents.splice(idx,1)}else origFn.call(this,type,listener,useCapture)})},wrap:function(fn,that,via){if("function"!=typeof fn)return fn;via=via||BOOMR.plugins.Errors.VIA_APP;BOOMR_check_doc_domain();return function(){try{return fn.apply(that,arguments)}catch(e){if(-2146823277===e.number&&(via===BOOMR.plugins.Errors.VIA_EVENTHANDLER||via===BOOMR.plugins.Errors.VIA_TIMEOUT))return;impl.send(e,via);throw e}}},test:function(){var fn,that,args;if(0!==arguments.length){fn=arguments[0];if("function"==typeof fn){that=arguments.length>1?arguments[1]:BOOMR.window;var args=Array.prototype.slice.call(arguments,2);return impl.wrap(fn,that).apply(that,args)}}},normalizeToString:function(obj){var message="";if(void 0===obj)message="undefined";else if(null===obj)message="null";else if("number"==typeof obj&&isNaN(obj))message="NaN";else if(""===obj)message="(empty string)";else if(0===obj)message="0";else if(obj)if("function"==typeof obj)message="(function)";else if(!obj||"number"!=typeof obj&&"string"!=typeof obj)if(obj&&obj instanceof Error)message=obj.toString();else if(obj&&obj instanceof Array){message+="[";for(var i=0;i<obj.length;i++){message+=impl.normalizeToString(obj[i]);","!==message[message.length-1]&&i!==obj.length-1&&(message+=",")}message+="]"}else if(obj&&"object"==typeof obj){var thrownObject;try{thrownObject={message:"Invalid ErrorType Thrown",extra:JSON.stringify(obj)}}catch(ex){thrownObject={message:"",extra:"Boomerang had a issue parsing error message see extra - "+ex}}message=thrownObject.message+" "+thrownObject.extra}else message="(unknown)";else message=obj.toString();else message="false";return message},compressErrors:function(errors){var i,j,err,frame,evt,minFrame,minEvent,o,obj,timestamp=0;o=BOOMR.window.location.origin;for(i=0;i<errors.length;i++){err=errors[i];obj={};1!==err.count&&(obj.n=err.count);if("number"==typeof err.timestamp){timestamp=err.timestamp;obj.d=err.timestamp.toString(36)}if(err.frames.length){obj.f=[];for(j=0;j<err.frames.length;j++){frame=err.frames[j];frame.lineNumber&&(frame.lineNumber=parseInt(frame.lineNumber,10));frame.columnNumber&&(frame.columnNumber=parseInt(frame.columnNumber,10));minFrame={l:frame.lineNumber,c:frame.columnNumber};"string"==typeof frame.fileName&&(-1!==frame.fileName.indexOf(o)?minFrame.wo=frame.fileName.replace(o,""):minFrame.w=frame.fileName);"string"==typeof frame.functionName&&(minFrame.f=frame.functionName);obj.f.push(minFrame)}}if(err.events.length){obj.e=[];for(j=0;j<err.events.length;j++){evt=err.events[j];minEvent={t:evt.type,d:timestamp?timestamp-evt.timestamp:evt.timestamp};if(evt.type===BOOMR.plugins.Errors.EVENT_CLICK){evt.id&&(minEvent.i=evt.id);evt.name&&(minEvent.n=evt.name);evt.tagName&&(minEvent.g=evt.tagName)}else if(evt.type===BOOMR.plugins.Errors.EVENT_NETWORK){evt.url&&(minEvent.u=evt.url);evt.method&&(minEvent.m=evt.method);evt.result&&(minEvent.r=evt.result)}else if(evt.type===BOOMR.plugins.Errors.EVENT_LOG){evt.severity&&(minEvent.s=evt.severity);evt.message&&(minEvent.m=evt.message)}obj.e.push(minEvent)}}err.source!==BOOMR.plugins.Errors.SOURCE_APP&&(obj.s=err.source);void 0!==err.via&&err.via!==BOOMR.plugins.Errors.VIA_APP&&(obj.v=err.via);void 0!==err.type&&"Error"!==err.type&&(obj.t=err.type);err.code&&(obj.c=err.code);err.message&&(obj.m=err.message);err.extra&&(obj.x=err.extra);errors[i]=obj}return errors}};var E=BOOMR.plugins.Errors={init:function(config){BOOMR.utils.pluginConfig(impl,config,"Errors",["onError","monitorGlobal","monitorNetwork","monitorConsole","monitorEvents","monitorTimeout","sendAfterOnload","sendInterval","maxErrors","imageErrors"]);if(impl.initialized)return this;config&&void 0!==config.autorun&&(impl.autorun=config.autorun);impl.initialized=!0;impl.supported=!0;if(!impl.supported)return this;BOOMR.subscribe("before_beacon",impl.beforeBeacon,null,impl);BOOMR.subscribe("beacon",impl.onBeacon,null,impl);BOOMR.subscribe("page_ready",impl.pageReady,null,impl);BOOMR.registerEvent("error");if(impl.monitorGlobal)try{BOOMR.globalOnError?BOOMR.window.onerror&&!BOOMR.window.onerror._bmr&&(BOOMR.globalOnError=BOOMR.window.onerror):BOOMR.globalOnError=BOOMR.window.onerror;BOOMR.window.onerror=function(message,fileName,lineNumber,columnNumber,error){void 0!==error&&null!==error?impl.send(error,E.VIA_GLOBAL_EXCEPTION_HANDLER):impl.send({message:message,fileName:fileName,lineNumber:lineNumber,columnNumber:columnNumber,noStack:!0},E.VIA_GLOBAL_EXCEPTION_HANDLER);"function"==typeof BOOMR.globalOnError&&BOOMR.globalOnError.apply(window,arguments)};impl.imageErrors&&!document.attachEvent&&document.addEventListener("error",function(event){var target=event.target,tag=target.tagName.toLowerCase();"img"===tag&&BOOMR.window.onerror(tag+" not found "+target.src,target.src,0,0,null)},!0);if(BOOMR.globalErrors){for(var i=0;i<BOOMR.globalErrors.length;i++)impl.send(BOOMR.globalErrors[i],E.VIA_GLOBAL_EXCEPTION_HANDLER);delete BOOMR.globalErrors}}catch(e){BOOMR.debug("Exception in the window.onerror handler","Errors")}impl.monitorNetwork&&BOOMR.subscribe("xhr_error",function(resource){var xhrJson,msg,stackTrace;msg="";stackTrace="";if(void 0!==resource.xhrMessage&&""!==resource.xhrMessage&&null!==resource.xhrMessage)try{xhrJson=JSON.parse(resource.xhrMessage);msg=xhrJson.Message&&xhrJson.ExceptionMessage?xhrJson.Message+" - "+xhrJson.ExceptionMessage+"|"+resource.url:JSON.stringify(xhrJson)+"|"+resource.url;stackTrace=xhrJson.StackTrace}catch(e){msg=resource.xhrMessage;stackTrace=""}resource.responseErrorGuid&&(msg=msg+"|"+resource.responseErrorGuid);resource.body&&(msg="Request Body:"+resource.body+" - "+msg);impl.send({code:resource.status,message:msg||resource.url,stack:stackTrace,noStack:!0,extra:resource.headers?resource.headers:void 0,noStack:!0},E.VIA_NETWORK)});if(impl.monitorConsole){BOOMR.window.console||(BOOMR.window.console={});var globalConsole=BOOMR.window.console.error;try{BOOMR.window.console.error=function(){var args=Array.prototype.slice.call(arguments);1===args.length?impl.send(impl.normalizeToString(args[0]),E.VIA_CONSOLE):impl.send(impl.normalizeToString(args),E.VIA_CONSOLE);"function"==typeof globalConsole&&("function"==typeof globalConsole.apply?globalConsole.apply(this,args):globalConsole(args[0],args[1],args[2]))}}catch(h){BOOMR.debug("Exception in the window.console.error handler","Errors")}}if(impl.monitorEvents)if(BOOMR.window.EventTarget){impl.wrapFn("addEventListener",BOOMR.window.EventTarget.prototype,!0,1,E.VIA_EVENTHANDLER);impl.wrapRemoveEventListener(BOOMR.window.EventTarget.prototype)}else{if(BOOMR.window){impl.wrapFn("addEventListener",BOOMR.window,!1,1,E.VIA_EVENTHANDLER);impl.wrapRemoveEventListener(BOOMR.window)}if(BOOMR.window.Node){impl.wrapFn("addEventListener",BOOMR.window.Node.prototype,!0,1,E.VIA_EVENTHANDLER);impl.wrapRemoveEventListener(BOOMR.window.Node.prototype)}if(BOOMR.window.XMLHttpRequest){impl.wrapFn("addEventListener",BOOMR.window.XMLHttpRequest.prototype,!0,1,E.VIA_EVENTHANDLER);impl.wrapRemoveEventListener(BOOMR.window.XMLHttpRequest.prototype)}}if(impl.monitorTimeout){impl.wrapFn("setTimeout",BOOMR.window,!1,0,E.VIA_TIMEOUT);impl.wrapFn("setInterval",BOOMR.window,!1,0,E.VIA_TIMEOUT)}return this},is_complete:function(){return!0},is_supported:function(){return impl.initialized&&impl.supported},SOURCE_APP:1,SOURCE_BOOMERANG:2,VIA_APP:1,VIA_GLOBAL_EXCEPTION_HANDLER:2,VIA_NETWORK:3,VIA_CONSOLE:4,VIA_EVENTHANDLER:5,VIA_TIMEOUT:6,EVENT_CLICK:1,EVENT_NETWORK:2,EVENT_LOG:3,send:impl.send,wrap:impl.wrap,test:impl.test,BoomerangError:BoomerangError}}}();!function(w){var d=w.document;if(document.getElementsByClassName){if(BOOMR.plugins.clicks)return;var impl={click_url:"",track_spa_clicks:!1,attributes:[],onbeforeunload:!1,retention:[],CLICKS_INITIATOR_KEY:"clicks",CLICKS_URL_KEY:"spa_url",CLICKS_DATA_KEY:"click_data",extractData:function(target,event,document_res,viewport){var data={element:target.nodeName,id:target.id,name:target.name,x:event.x,y:event.y,scrollY:window.scrollY,document_height:document_res.height,document_width:document_res.width,viewport_height:viewport.height,viewport_width:viewport.width};for(i=0;i<impl.attributes.length;i++){var attributeName=impl.attributes[i],attribute=target.getAttribute(attributeName);attribute&&(data[attributeName]=attribute)}return data},handleEvent:function(event){if(void 0!==impl.click_url){var target=null;event.target?target=event.target:event.srcElement&&(target=event.srcElement);var document_res=impl.getDocumentSize(),viewport=impl.getViewport(),data=impl.extractData(target,event,document_res,viewport);data["class"]=target.classList;if(void 0===impl.onbeforeunload||!1===impl.onbeforeunload){BOOMR.info("No preference set for when to send clickstats, will default to send immediately");impl.sendData(data)}else impl.retention.push(data)}else BOOMR.error("No Beacon URL defined will not send beacon")},sendData:function(data){var keys=Object.keys(data),urlenc="";for(var i in keys)urlenc+=keys[i]+"="+data[keys[i]]+"&";BOOMR.info("Url-encoded string: "+urlenc);var url=impl.click_url+"?"+urlenc,img=new Image;img.src=url;img.remove()},unload:function(){impl.retention.forEach(function(data){impl.sendData(data)})},unloadSpa:function(boomrEventArr){if(impl.retention&&impl.retention.length>0){var clickData={clicks:impl.retention,documentSize:impl.getDocumentSize(),viewPort:impl.getViewport()},originatingUrl=boomrEventArr&&boomrEventArr.length>=2?boomrEventArr[1]:window.location.href;BOOMR.addVar(impl.CLICKS_URL_KEY,originatingUrl);BOOMR.addVar(impl.CLICKS_DATA_KEY,JSON.stringify(clickData));impl.retention=[]}},getDocumentSize:function(){return{height:Math.max(d.body.scrollHeight,d.documentElement.scrollHeight,d.body.offsetHeight,d.documentElement.offsetHeight,d.body.clientHeight,d.documentElement.clientHeight),width:Math.max(d.body.scrollWidth,d.documentElement.scrollWidth,d.body.offsetWidth,d.documentElement.offsetWidth,d.body.clientWidth,d.documentElement.clientWidth)}},getViewport:function(){var viewPortWidth,viewPortHeight;if(void 0!==window.innerWidth){viewPortWidth=window.innerWidth;viewPortHeight=window.innerHeight}else if(void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!==document.documentElement.clientWidth){viewPortWidth=document.documentElement.clientWidth;viewPortHeight=document.documentElement.clientHeight}else{viewPortWidth=document.getElementsByTagName("body")[0].clientWidth;viewPortHeight=document.getElementsByTagName("body")[0].clientHeight}return{width:viewPortWidth,height:viewPortHeight}},cleanClickData:function(){BOOMR.removeVar(impl.CLICKS_DATA_KEY);BOOMR.removeVar(impl.CLICKS_URL_KEY)}};BOOMR.plugins.Clicks={init:function(config){var properties=["click_url","onbeforeunload","track_spa_clicks","attributes"];BOOMR.utils.pluginConfig(impl,config,"clicks",properties);w.addEventListener("click",impl.handleEvent,!0);if(impl.track_spa_clicks){impl.onbeforeunload=!0;BOOMR.subscribe("onbeaconsent",impl.cleanClickData,null,impl);BOOMR.subscribe("spa_init",impl.unloadSpa,null,impl);w.addEventListener("beforeunload",impl.unloadSpa,!0)}else w.addEventListener("beforeunload",impl.unload,!0);return this},send_on_spa:function(from){impl.unloadSpa(from)},is_complete:function(){return!0}}}}(window);!function(){function setVars(){var k;for(k in param_map)if(void 0!==connection[k]){BOOMR.removeVar("mob."+param_map[k]);connection[k]&&BOOMR.addVar("mob."+param_map[k],connection[k])}}var connection,param_map={type:"ct",bandwidth:"bw",metered:"mt",effectiveType:"etype",downlinkMax:"lm",downlink:"dl",rtt:"rtt",saveData:"sd"};if("function"==typeof BOOMR.addVar){"object"==typeof navigator&&(connection=navigator.connection||navigator.mozConnection||navigator.webkitConnection||navigator.msConnection);if(connection){connection.addEventListener&&connection.addEventListener("change",function(){setVars();BOOMR.fireEvent("netinfo",connection)});setVars()}}}();!function(BOOMR){"use strict";var mcmID,impl;BOOMR=BOOMR||{};if(!BOOMR.plugins.mcmIDCapture){impl={VALUE_PARSE_REGEX:/CMCMID%7C([\w\d]+)%7/,COOKIE_REGEX:/AMCV_[\w\d]+%40AdobeOrg=([^;]+)/,MCM_ID_BEACON_KEY:"mcmid",addMcmIdToBeacon:function(){void 0===mcmID&&(mcmID=impl.getMcmIdFromCookie(impl.getAmcvCookie()));BOOMR.addVar(impl.MCM_ID_BEACON_KEY,mcmID)},getAmcvCookie:function(){var match=document.cookie.match(impl.COOKIE_REGEX);return impl.getSelectedGroup(match)},getMcmIdFromCookie:function(cookieValue){var parsedCookie=impl.VALUE_PARSE_REGEX.exec(cookieValue);return impl.getSelectedGroup(parsedCookie)},getSelectedGroup:function(value){var parsedValue="";null!==value&&value.length>=2&&(parsedValue=value[1]);return parsedValue}};BOOMR.plugins.mcmIDCapture={init:function(config){var properties=[];BOOMR.utils.pluginConfig(impl,config,"mcmIDCapture",properties);BOOMR.subscribe("before_beacon",impl.addMcmIdToBeacon,null,impl);return this},is_complete:function(){return!0}}}}(BOOMR);!function(BOOMR){"use strict";var impl;BOOMR=BOOMR||{};if(!BOOMR.plugins.applicationInfo){impl={APPLICATIONID_BEACON_KEY:"application_id",SERVERNAME_BEACON_KEY:"server_name",USERCONTEXT_BEACON_KEY:"user_obj",setup:function(){var varsToAdd=[];impl.getAppId&&varsToAdd.push({key:impl.APPLICATIONID_BEACON_KEY,value:impl.getAppId()});impl.getServerName&&varsToAdd.push({key:impl.SERVERNAME_BEACON_KEY,value:impl.getServerName()});impl.getUserObj&&varsToAdd.push({key:impl.USERCONTEXT_BEACON_KEY,value:JSON.stringify(impl.getUserObj())});varsToAdd.length>0&&BOOMR.subscribe("before_beacon",impl.addVars,varsToAdd,impl)},addVars:function(beacon,vars){for(var i=0;i<vars.length;i++)BOOMR.addVar(vars[i].key,vars[i].value)}};BOOMR.plugins.applicationInfo={init:function(config){var properties=["getAppId","getServerName","getUserObj"];BOOMR.utils.pluginConfig(impl,config,"applicationInfo",properties);BOOMR.subscribe("page_ready",impl.setup,null,impl);BOOMR.subscribe("dom_loaded",impl.setup,null,impl);return this},initialize:function(applicationInfo){if(applicationInfo){applicationInfo.appId&&(impl.getAppId=function(){return applicationInfo.appId});applicationInfo.userObject&&(impl.getServerName=function(){return applicationInfo.userObject});applicationInfo.serverName&&(impl.getUserObj=function(){return applicationInfo.serverName});impl.setup()}},is_complete:function(){return!0}}}}(BOOMR);!function(w){"use strict";var impl,navigationExecutedTimeout,retryBaseDelay=200,maxRetryCount=10,retryCount=0;if(!BOOMR.plugins.iperceptions){BOOMR=BOOMR||{};impl={triggerIperceptions:function(boomrEventArr){var spaUrl=boomrEventArr&&boomrEventArr.length>=2?boomrEventArr[1]:window.location.href;impl.navigationExecuted(spaUrl)},navigationExecuted:function(spaUrl){if(w.iPerceptions&&w.iPerceptions.Wrapper&&"function"==typeof w.iPerceptions.Wrapper.exec){w.iPerceptions.Wrapper.exec(spaUrl,!0);impl.clearRetryVariables()}else impl.retry(spaUrl)},clearRetryVariables:function(){retryCount>0&&w.clearTimeout(navigationExecutedTimeout);retryCount=0},retry:function(spaUrl){retryCount++;retryCount>maxRetryCount?impl.clearRetryVariables():navigationExecutedTimeout=w.setTimeout(function(){impl.navigationExecuted(spaUrl)},retryBaseDelay*retryCount)}};BOOMR.plugins.iperceptions={init:function(config){BOOMR.utils.pluginConfig(impl,config,"iperceptions",[]);BOOMR.subscribe("spa_init",impl.triggerIperceptions,null,impl);return this},is_complete:function(){return!0}}}}(window);!function(BOOMR){"use strict";var impl;if(!BOOMR.plugins.tlsData){impl={TLS_BEACON_KEY:"tls",TLS_URL:"//i.dell.com/tlsdata",HTTP_GET:"GET",setup:function(){try{var xmlHttp=new XMLHttpRequest;xmlHttp.onreadystatechange=function(){4===xmlHttp.readyState&&200===xmlHttp.status&&BOOMR.subscribe("before_beacon",impl.addTlsToBeacon,xmlHttp.responseText,impl)};xmlHttp.open(impl.HTTP_GET,impl.TLS_URL,!0);xmlHttp.send(null)}catch(e){}},addTlsToBeacon:function(beacon,tls){BOOMR.addVar(impl.TLS_BEACON_KEY,tls)}};BOOMR.plugins.tlsData={init:function(config){BOOMR.utils.pluginConfig(impl,config,"tlsData",[]);impl.setup();return this},is_complete:function(){return!0}}}}(BOOMR);!function(w){"use strict";var impl;if(!BOOMR.plugins.omniture){BOOMR=BOOMR||{};impl={TTI_SPA_TYPES:["spa","spa_hard"],prepareOmnitureData:function(){var httpInitiator=BOOMR.getVar("http.initiator");(BOOMR.utils.inArray(httpInitiator,impl.TTI_SPA_TYPES)||BOOMR.getVar("c.tti"))&&impl.buildOmnitureTti(httpInitiator)},buildOmnitureTti:function(httpInitiator){if(w.Dell&&w.Dell.Metrics&&w.Dell.Metrics.sc){var tti=impl.getValueOrDefault(BOOMR.getVar("c.tti"),BOOMR.getVar("t_done")),timeToInteractVisuallyReady=impl.getValueOrDefault(BOOMR.getVar("c.tti.vr"),BOOMR.getVar("pt.fcp")),t_done=impl.getValueOrDefault(BOOMR.getVar("t_done")),timeToFirstInteraction=impl.getValueOrDefault(BOOMR.getVar("c.ttfi")),firstInputDelay=impl.getValueOrDefault(BOOMR.getVar("c.fid")),averageFrameRate=impl.getValueOrDefault(BOOMR.getVar("c.f")),pageExecution=impl.getValueOrDefault(BOOMR.getVar("t_page")),networkTimeMs=impl.getValueOrDefault(BOOMR.getVar("t_resp")),omnitureStr=tti+"|"+timeToInteractVisuallyReady+"|"+t_done+"|"+timeToFirstInteraction+"|"+firstInputDelay+"|"+averageFrameRate+"|"+pageExecution+"|"+networkTimeMs+"|"+httpInitiator+"|",validationStr=impl.getValidationChar(tti)+"|"+impl.getValidationChar(timeToInteractVisuallyReady)+"|"+impl.getValidationChar(t_done)+"|"+impl.getValidationChar(timeToFirstInteraction)+"|"+impl.getValidationChar(firstInputDelay)+"|"+impl.getValidationChar(averageFrameRate)+"|"+impl.getValidationChar(pageExecution)+"|"+impl.getValidationChar(networkTimeMs);w.Dell.Metrics.sc.boomerangtti=omnitureStr+validationStr;BOOMR.debug("Dell.Metrics.sc: "+w.Dell.Metrics.sc.boomerangtti)}},getValidationChar:function(ttiVar){return isNaN(ttiVar)||ttiVar<0||ttiVar>999999?"N":"Y"},getValueOrDefault:function(preferredValue,backUpValue){var value=preferredValue||backUpValue;return!value||isNaN(value)?-1:value}};BOOMR.plugins.omniture={init:function(config){var properties=[];BOOMR.utils.pluginConfig(impl,config,"omniture",properties);BOOMR.subscribe("before_beacon",impl.prepareOmnitureData,null,impl);return this},is_complete:function(){return!0}}}}(window);!function(w){"use strict";var impl,defaultValues={dpi:96,dpcm:96/2.54};BOOMR=BOOMR||{};if(!BOOMR.plugins.screenMetrics){impl={getScreenMetrics:function(){function getIeDppx(){return Math.sqrt(screen.deviceXDPI*screen.deviceYDPI)/defaultValues.dpi}function dppx(){return"undefined"==typeof window?0:+window.devicePixelRatio||getIeDppx()||0}function dpcm(){return dppx()*defaultValues.dpcm}function dpi(){return dppx()*defaultValues.dpi}var screenMetrics={screenWidth:w.screen.width,screenHeight:w.screen.height,browserWidth:w.innerWidth,browserHeight:w.innerHeight,cssPixelRatio:w.devicePixelRatio,jsPixelRatio:w.devicePixelRatio||w.screen.availWidth/document.documentElement.clientWidth,resolutionDpi:dpi(),resolutionDppx:dppx(),resolutionDpcm:dpcm().toFixed(2),orientation:w.screen.msOrientation||(w.screen.orientation||w.screen.mozOrientation||{}).type,screenAspectRation:(w.screen.width/w.screen.height).toFixed(2),browserAspectRation:(w.innerWidth/w.innerHeight).toFixed(2)};BOOMR.addVar("screenMetrics",JSON.stringify(screenMetrics))}};BOOMR.plugins.screenMetrics={init:function(config){BOOMR.utils.pluginConfig(impl,config,"screenMetrics",[]);BOOMR.subscribe("before_beacon",impl.getScreenMetrics,null,impl);return this},is_complete:function(){return!0}}}}(window);BOOMR.t_end=(new Date).getTime();